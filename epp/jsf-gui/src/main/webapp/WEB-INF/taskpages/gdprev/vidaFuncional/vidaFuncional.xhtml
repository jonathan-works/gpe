<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:wi="http://www.itx.com.br/jsf"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:s="http://jboss.org/schema/seam/taglib"
    xmlns:infox="http://www.infox.com.br/jsf"
    xmlns:p="http://primefaces.org/ui"
    xmlns:i="http://java.sun.com/jsf/composite/infox">

    <p:panel header="#{vidaFuncionalGDPrevTaskPageController.label}">
        <fieldset>
            <legend>Buscar</legend>
            <h:form>
                <wi:field id="nome" label="Nome">
                    <h:inputText id="nomeInput" value="#{vidaFuncionalGDPrevTaskPageController.filtroVidaFuncionalGDPrev.nome}" />
                </wi:field>

                <wi:inputCpf id="cpf" label="CPF" value="#{vidaFuncionalGDPrevTaskPageController.filtroVidaFuncionalGDPrev.cpf}"/>

                <wi:inputNumber id="matricula" label="Matrícula" onkeyup="onlyPositiveNumber(this)"
                    value="#{vidaFuncionalGDPrevTaskPageController.filtroVidaFuncionalGDPrev.matricula}"/>

                <div>
                    <p:commandButton value="Buscar" process="@form" update="@form @(.vidaFuncionalTable) :pageBodyDialogMessage"
                        action="#{vidaFuncionalGDPrevTaskPageController.buscarDocumentos}" styleClass="buttons"
                        onstart="infox.showLoading()" oncomplete="infox.hideLoading()"/>
                </div>
            </h:form>
        </fieldset>

        <p:outputPanel styleClass="vidaFuncionalTable" layout="block" style="margin-top: 10px">
            <h:form>
                <p:dataTable var="row" lazy="true" value="#{vidaFuncionalGDPrevDataModel}" binding="#{vidaFuncionalGDPrevDataModel.dataTable}"
                    paginator="true" paginatorAlwaysVisible="true" paginatorPosition="both" emptyMessage="#{infoxMessages['list.defaultNoDataLabel']}"
                    rows="20" rendered="#{not vidaFuncionalGDPrevDataModel.filtroVidaFuncionalGDPrev.isEmpty()}">

                    <p:ajax event="page" onstart="infox.showLoading()" oncomplete="infox.hideLoading()" />

                    <p:column style="width: 75px; text-align: center">
                        <p:commandButton value="Baixar" process="@this" update="@form" styleClass="buttons"/>
                    </p:column>

                    <p:column headerText="CPF" style="text-align: center; width: 10%">
                        <h:outputText value="#{row.cpfServidor}" />
                    </p:column>

                    <p:column headerText="Matrícula" style="text-align: center; width: 10%">
                        <h:outputText value="#{row.matriculaServidor}" />
                    </p:column>

                    <p:column headerText="Nome" style="width: 20%">
                        <h:outputText value="#{row.nomeServidor}" />
                    </p:column>

                    <p:column headerText="Data" style="text-align: center; width: 10%">
                        <h:outputText value="#{row.data}">
                            <f:convertDateTime pattern="dd/MM/yyyy" />
                        </h:outputText>
                    </p:column>

                    <p:column headerText="Fonte">
                        <h:outputText value="#{row.fonte}" />
                    </p:column>

                    <p:column headerText="Descrição" style="width: 30%">
                        <h:outputText value="#{row.descricao}" />
                    </p:column>

                    <f:facet name="footer">
                        <i:datatableRowCount rowCount="#{vidaFuncionalGDPrevDataModel.rowCount}" />
                    </f:facet>
                </p:dataTable>
            </h:form>
        </p:outputPanel>
    </p:panel>
</ui:composition>
