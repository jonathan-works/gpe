<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:ui="http://java.sun.com/jsf/facelets" 
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:wi="http://www.itx.com.br/jsf"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a="http://richfaces.org/a4j"
      xmlns:s="http://jboss.org/schema/seam/taglib">
<h:head />
<h:body>
	<h:form>
		<h:commandButton value="Visualizar Comunicação" action="#{respostaComunicacaoAction.downloadComunicacao}" 
			styleClass="buttons" />
	</h:form>
	<h:form>
		<rich:collapsiblePanel header="Editor" switchType="client">
			<s:div>
				<wi:inputText id="descricao" value="#{respostaComunicacaoAction.documentoEdicao.descricao}"
					required="true" label="#{eppmessages['processo.anexarDocumentoDescricao']}" />
			</s:div>
			<wi:selectOneMenuEntity id="modeloDocumento" value="#{respostaComunicacaoAction.modeloDocumento}" 
				label="#{eppmessages['modeloDocumento.modeloDocumento']}"
				noSelectionLabel="[Selecione o modelo]" items="#{respostaComunicacaoAction.modelosDocumento}">
				<a:ajax event="change" render="respostaComunicacaoDiv" execute="@this" limitRender="true"
					listener="#{respostaComunicacaoAction.assignModeloDocumento}"/>
			</wi:selectOneMenuEntity>
			
			<s:div>
 				<wi:selectOneMenuEntity id="classificacao"
	  				label="#{eppmessages['processoDocumento.classificacaoDocumento']}"
		      		items="#{respostaComunicacaoAction.classificacoesEditor}"
		      		showLabelSelecione="true"
		      		required="true"
		      		value="#{respostaComunicacaoAction.documentoEdicao.classificacaoDocumento}"
		      		readonly="#{respostaComunicacaoAction.classificacoesEditor.size eq 1}"
   					disabled="#{respostaComunicacaoAction.classificacoesEditor.size eq 1}">
   					<a:ajax event="change"
      					render="tooltipComunicacao"
      					execute="@this"
      					limitRender="true" />
  				</wi:selectOneMenuEntity>
			</s:div>
					
			<s:div id="tooltipComunicacao">
		   		<s:div styleClass="tooltip-parent" style="width: 10px" 
		  			rendered="#{not empty respostaComunicacaoAction.documentoEdicao.classificacaoDocumento.observacao}">
		  		<h:graphicImage url="#{wiSkin.imageFolder}/help.gif" />
					<div class="epp-tooltip">
						<div class="tooltip-panel">
							<div><h:outputText value="Observação:"/></div>
							<h:outputText value="#{respostaComunicacaoAction.documentoEdicao.classificacaoDocumento.observacao}"/>
						</div>
					</div>
		   		</s:div>
			</s:div>
			<wi:selectBooleanRadio id="minuta" value="#{respostaComunicacaoAction.minuta}" label="Minuta" />
			<s:div id="respostaComunicacaoDiv">
				<wi:editor id="respostaComunicacao" value="#{respostaComunicacaoAction.documentoEdicao.documentoBin.modeloDocumento}" />
			</s:div>
			<wi:commandButton id="gravarResposta" action="respostaComunicacaoAction.gravarResposta" 
				value="Gravar" reRender="pageBodyDialogMessage, @form, respostasPanel"/>
		</rich:collapsiblePanel>
	</h:form>
	<h:form>
		<rich:collapsiblePanel header="Anexo" switchType="client">
			<wi:fileUpload id="documentoResposta" 
				accept="#{respostaComunicacaoAction.classificacaoAnexo.acceptedTypes}" />
			<wi:commandButton id="gravarResposta" action="respostaComunicacaoAction.gravarAnexoResposta" 
				value="Gravar" reRender="pageBodyDialogMessage, @form, respostasPanel"/>
		</rich:collapsiblePanel>
	</h:form>
	<wi:dataTable id="respostas" tableTitle="Respostas" bean="#{respostaComunicacaoList}"
		values="#{respostaComunicacaoList.list(10)}" rowId="#{row.id}" hideOrder="true">
		<ui:define name="searchForm">
			<wi:searchForm formId="respostasForm" searchReRender="respostasPanel, respostasSearchForm"
				clearReRender="respostasPanel, respostasSearchForm">
				<wi:inputText value="#{respostaComunicacaoList.entity.descricao}" label="Descrição" />
			</wi:searchForm>
		</ui:define>
		<ui:define name="headerToolBar" />
		<ui:define name="toolBar">
		</ui:define>
		<wi:columnOutputText columnHeader="Descrição" value="#{row.descricao}" />
	</wi:dataTable>
</h:body>
</html>