<?xml version="1.0" encoding="UTF-8"?>
<ui:composition
	 xmlns:ui="http://java.sun.com/jsf/facelets"
	 xmlns="http://www.w3.org/1999/xhtml"
	 xmlns:c="http://java.sun.com/jsp/jstl/core"
	 xmlns:f="http://java.sun.com/jsf/core"
	 xmlns:h="http://java.sun.com/jsf/html"
	 xmlns:rich="http://richfaces.org/rich"
	 xmlns:infox="http://www.infox.com.br/jsf"
	 xmlns:s="http://jboss.org/schema/seam/taglib"
	 xmlns:wi="http://www.itx.com.br/jsf" 
	 xmlns:a="http://richfaces.org/a4j">

	<ui:param
		 name="home"
		 value="#{dominioVariavelTarefaCrudAction}" />
    <infox:tabPanel
             id="defaultTabPanel"
             switchType="ajax"
             activeTab="#{home.tab}">
            <h:form><infox:tabHeaders /></h:form>
            
            <infox:tabChangeListener listener="#{crudTabCleaner}" />

            <infox:tab
                 id="search"
                 name="search"
                 immediate="true"
                 status=":status"
                 title="#{infoxMessages['template.abaPesquisaText']}"
                 action="#{home.onClickSearchTab}"
                 style="border-style: solid; border-width: 1px; border-color: lightgray">
                 <a:region>
                    <s:div id="searchGridRegion">
                        <wi:dataTable id="dominioVariavelTarefaList"
                            values="#{dominioVariavelTarefaList.list(10)}"
                            bean="#{dominioVariavelTarefaList}"
                            rowId="#{row.id}"
                            tableTitle="#{infoxMessages['dominioVariavelTarefa.list']}">
                            
                            <ui:define name="searchForm">
                                <wi:searchForm formId="pesquisarDominioVariavelTarefaForm" formTitle="#{infoxMessages['dominioVariavelTarefa.form']}"
                                    searchReRender="search" clearReRender="search">
                                    <wi:inputText id="nome" label="#{infoxMessages['dominioVariavelTarefa.nome']}"
                                        value="#{dominioVariavelTarefaList.entity.nome}" />
                                </wi:searchForm>
                            </ui:define>
                            
                            <ui:define name="headerToolBar" />
                            <ui:define name="toolBar">
                                <h:form>
	                                <a:commandLink execute="@this" render="defaultTabPanel" limitRender="true">
	                                   <h:graphicImage url="#{layoutController.getResourceUrlByPath('/imagens/mod/edit.gif')}" title="Editar" />
								       <f:setPropertyActionListener
								            target="#{dominioVariavelTarefaCrudAction.id}" value="#{row.id}" />
								       <f:setPropertyActionListener
								            target="#{dominioVariavelTarefaCrudAction.tab}" value="form" />
								    </a:commandLink>
                                    <a:commandLink action="#{dominioVariavelTarefaCrudAction.selecionarDominio}"
                                        onbegin="showLoading()" execute="@this" limitRender="true" 
                                        oncomplete="hideLoading(); #{rich:component('dominioVariavelTarefaPanel')}.hide()">
                                        <f:setPropertyActionListener target="#{dominioVariavelTarefaCrudAction.instance}" value="#{row}" />
                                        <h:graphicImage url="#{layoutController.getResourceUrlByPath('/imagens/view.png')}" title="#{infoxMessages['dominioVariavelTarefa.select']}" />
                                    </a:commandLink>
                                </h:form>
                            </ui:define>
                            
                            <wi:columnOutputText columnId="nome" columnHeader="#{infoxMessages['dominioVariavelTarefa.nome']}" value="#{row.nome}" />
                            <wi:columnOutputText columnId="codigo" columnHeader="#{infoxMessages['dominioVariavelTarefa.codigo']}" value="#{row.codigo}" />
                            
                        </wi:dataTable>
                    </s:div>
                 </a:region>
            </infox:tab>

            <infox:tab
                 id="form"
                 name="form"
                 immediate="true"
                 status=":status"
                 title="#{infoxMessages['template.abaFormularioText']}"
                 action="#{home.onClickFormTab}"
                 style="border-style: solid; border-width: 1px; border-color: lightgray">
                <a:region>
                    <wi:dataForm formId="dominioVariavelTarefaForm" formTitle="#{infoxMessages['dominioVariavelTarefa.form']}">
                        <wi:inputText id="codigo" label="#{infoxMessages['dominioVariavelTarefa.codigo']}"
                                    value="#{dominioVariavelTarefaCrudAction.instance.codigo}" required="true"/>
                        <wi:inputText id="nome" label="#{infoxMessages['dominioVariavelTarefa.nome']}"
                                    value="#{dominioVariavelTarefaCrudAction.instance.nome}" required="true"/>
                        <wi:inputTextarea id="dominio" label="#{infoxMessages['dominioVariavelTarefa.dominio']}"
                            required="true" value="#{dominioVariavelTarefaCrudAction.instance.dominio}" 
                            showCounter="false">
                            <f:validator validatorId="dominioVariavelTarefaValidator" />
                        </wi:inputTextarea>
                            
                        <ui:define name="buttons">
                            <wi:commandButtonSave reRender="defaultTabPanel pageBodyDialogMessage" styleClass="buttons" />
                            <wi:commandButtonNew reRender="defaultTabPanel pageBodyDialogMessage" styleClass="buttons" />
                            <a:commandButton action="#{dominioVariavelTarefaCrudAction.selecionarDominio}"
								onbegin="showLoading()" execute="@this" limitRender="true" 
								oncomplete="hideLoading(); #{rich:component('dominioVariavelTarefaPanel')}.hide()" 
								value="#{infoxMessages['dominioVariavelTarefa.select']}" 
								rendered="#{dominioVariavelTarefaCrudAction.managed}"
								styleClass="buttons"/> 
                        </ui:define>
                    </wi:dataForm>
                </a:region>
        </infox:tab>
    </infox:tabPanel>

</ui:composition>
