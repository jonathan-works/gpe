<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- $Id: listView.xhtml 750 2010-08-24 14:10:58Z danielsilva $ --><ui:composition
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:a="http://richfaces.org/a4j"
     xmlns:c="http://java.sun.com/jsp/jstl/core"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:rich="http://richfaces.org/rich"
     xmlns:s="http://jboss.org/schema/seam/taglib"
     xmlns:wi="http://www.itx.com.br/jsf"
     template="/WEB-INF/xhtml/templates/core/menuTemplate.xhtml">
                       
	<ui:define
         name="title">#{messages['dashBoard.titlePage']}</ui:define>
	
	<ui:param
         name="action"
         value="#{dashBoardAction}" />
	
	<ui:define
         name="body">
		<a:region
             renderRegionOnly="true">
			<h:form>
				<rich:spacer
                     height="30px" />
		  		<h:outputText
                     value="Por Categoria:"
                      />
				<rich:dataTable
                     id="tarefaByCategoriaGrid"
                     value="#{action.categoriaList}"
                     var="row"
                     rows="10"
                     title="Por Categoria"
                     >
					<f:facet
                         name="header">
						<rich:columnGroup>
							<rich:column
                                 >
								<h:outputText
                                     value="Categoria" />
							</rich:column>
							<rich:column
                                 >
								<h:outputText
                                     value="Qtd em Andamento" />
							</rich:column>
							<rich:column
                                 >
								<h:outputText
                                     value="Prazo Fluxo" />
							</rich:column>
							<rich:column
                                 >
								<h:outputText
                                     value="Prazo Tarefa" />
							</rich:column>
							<rich:column
                                 >
								<h:outputText
                                     value="C/ Prazo Tarefas &gt; 100%" />
							</rich:column>
							<rich:column
                                 breakBefore="true">
								<h:outputText
                                     value="Dentro" />
							</rich:column>
							<rich:column>
								<h:outputText
                                     value="Fora" />
							</rich:column>
							<rich:column>
								<h:outputText
                                     value="Dentro" />
							</rich:column>
							<rich:column>
								<h:outputText
                                     value="Fora" />
							</rich:column>
						</rich:columnGroup>
					</f:facet>
					<rich:column
                         >
						<h:outputText
                             value="#{row[0]}" />
					</rich:column>
					<rich:column
                         >
						<h:outputText
                             value="#{row[1]}" />
					</rich:column>
					<rich:column
                         >
						<h:outputText
                             value="#{(row[3]*100) div row[1]}">
							<f:convertNumber
                                 maxFractionDigits="1" />
						</h:outputText>
						<h:outputText
                             value="%" />
					</rich:column>
					<rich:column
                         >
						<ui:param
                             name="foraPrazoFluxo"
                             value="#{(row[1]-row[3])*100 div row[1]}" />
						<a:commandLink
                             action="#{action.byProcessoForaPrazo(row[0], foraPrazoFluxo)}"
                             execute="@this"
                             render="gridByCurrentTask"
                             limitRender="true">
							<h:outputText
                                 value="#{foraPrazoFluxo}">
								<f:convertNumber
                                     maxFractionDigits="1" />
							</h:outputText>
							<h:outputText
                                 value="%" />
						</a:commandLink>
					</rich:column>
					<rich:column
                         >
						<h:outputText
                             value="#{(row[2]*100) div (row[4]+row[2])}">
							<f:convertNumber
                                 maxFractionDigits="1" />
						</h:outputText>
						<h:outputText
                             value="%" />
					</rich:column>
					<rich:column
                         >
						<ui:param
                             name="foraPrazoTarefa"
                             value="#{(row[4])*100 div (row[4]+row[2])}" />
						<a:commandLink
                             action="#{action.byProcessoForaTarefa(row[0], foraPrazoTarefa)}"
                             execute="@this"
                             render="gridByCurrentTask"
                             limitRender="true">
							<h:outputText
                                 value="#{foraPrazoTarefa}">
								<f:convertNumber
                                     maxFractionDigits="1" />
							</h:outputText>
							<h:outputText
                                 value="%" />
						</a:commandLink>
					</rich:column>
					<rich:column
                         >
						<h:outputText
                             value="#{(row[4]*100) div row[1]}">
							<f:convertNumber
                                 maxFractionDigits="1" />
						</h:outputText>
						<h:outputText
                             value="%" />
					</rich:column>
				</rich:dataTable>
				<rich:dataScroller
                     for="tarefaByCategoriaGrid"
                     lastPageMode="full"
                     id="dsTarefaByCategoriaTable"
                     align="left"
                     renderIfSinglePage="false" />
				<rich:spacer
                     height="30px" />
		  		<h:outputText
                     value="Perto do Limite:"
                      />
				<rich:dataTable
                     id="tarefaPertoLimiteGrid"
                     value="#{action.tarefaPertoLimiteList}"
                     var="row"
                     rows="10"
                     title="Perto do Limite"
                     >
					<f:facet
                         name="header">
						<rich:columnGroup>
							<rich:column
                                 >
								<h:outputText
                                     value="Fluxo" />
							</rich:column>
							<rich:column
                                 >
								<h:outputText
                                     value="Processo" />
							</rich:column>
							<rich:column
                                 >
								<h:outputText
                                     value="Tarefa" />
							</rich:column>
							<rich:column
                                 >
								<h:outputText
                                     value="% Tempo Gasto" />
							</rich:column>
							<rich:column
                                 >
								<h:outputText
                                     value="Tempo Previsto" />
							</rich:column>
						</rich:columnGroup>
					</f:facet>
					<rich:column
                         >
						<h:outputText
                             value="#{row[0]}" />
					</rich:column>
					<rich:column
                         >
						<h:outputText
                             value="#{row[1].numeroProcesso}" />
					</rich:column>
					<rich:column
                         >
						<h:outputText
                             value="#{row[2]}" />
					</rich:column>
					<rich:column
                         >
						<h:outputText
                             value="#{row[3].porcentagem}%" />
					</rich:column>
					<rich:column
                         >
						<h:outputText
                             value="#{action.getTempo(row[3].tempoPrevisto)}" />
					</rich:column>
				</rich:dataTable>
				<rich:dataScroller
                     for="tarefaPertoLimiteGrid"
                     lastPageMode="full"
                     id="dsTarefaPertoLimiteTable"
                     align="left"
                     renderIfSinglePage="false" />
				<s:div
                     id="gridByCurrentTask">
					<s:div
                         rendered="#{action.showForaPrazoGrid}">
						<rich:spacer
                             height="15px" />
						<rich:panel
                             header="Por Tarefa"
                             >
							<rich:spacer
                                 height="15px" />
					  		<h:outputText
                                 value="Fora do Prazo:"
                                  /> 
							<rich:dataTable
                                 id="tarefaForaPrazoGrid"
                                 value="#{action.tarefaForaPrazoList}"
                                 var="row"
                                 rows="10"
                                 title="Fora de Prazo"
                                 >
								<f:facet
                                     name="header">
									<rich:columnGroup>
										<rich:column
                                             >
											<h:outputText
                                                 value="Fluxo" />
										</rich:column>
										<rich:column
                                             >
											<h:outputText
                                                 value="Processo" />
										</rich:column>
										<rich:column
                                             >
											<h:outputText
                                                 value="Tarefa" />
										</rich:column>
										<rich:column
                                             >
											<h:outputText
                                                 value="Tempo Previsto" />
										</rich:column>
										<rich:column
                                             >
											<h:outputText
                                                 value="Tempo Gasto" />
										</rich:column>
									</rich:columnGroup>
								</f:facet>
								<rich:column
                                     >
									<h:outputText
                                         value="#{row[0]}" />
								</rich:column>
								<rich:column
                                     >
									<h:outputText
                                         value="#{row[1].numeroProcesso}" />
								</rich:column>
								<rich:column
                                     >
									<h:outputText
                                         value="#{row[2]}" />
								</rich:column>
								<rich:column
                                     >
									<h:outputText
                                         value="#{action.getTempo(row[3].tempoPrevisto)}" />
								</rich:column>
								<rich:column
                                     >
									<h:outputText
                                         value="#{action.getTempo(row[3].tempoGasto)}" />
								</rich:column>
							</rich:dataTable>
							<rich:dataScroller
                                 for="tarefaForaPrazoGrid"
                                 lastPageMode="full"
                                 id="dsTarefaForaPrazoTable"
                                 align="left"
                                 renderIfSinglePage="false" />
						</rich:panel>
					</s:div>
				</s:div>
			</h:form>
		</a:region>
	</ui:define>

</ui:composition>
