<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:wi="http://www.itx.com.br/jsf"
    xmlns:infox="http://www.infox.com.br/jsf"
    template="/WEB-INF/xhtml/templates/core/defaultTemplate.xhtml">

    <ui:define name="title">#{infoxMessages['monitorProcesso.titlePage']}</ui:define>

    <ui:param name="home" value="#{monitorProcessoView}" />
    <ui:param name="showFormTab" value="false" />

    <ui:define name="searchGrid">
        <wi:dataTable id="fluxoList"
            values="#{fluxoList.list(15)}" bean="#{fluxoList}"
            tableTitle="#{infoxMessages['monitorProcesso.fluxo.tableTitle']}"
            rowId="#{row.idFluxo}">

            <ui:define name="searchForm">
                <wi:searchForm formId="pesquisarFluxoForm" formTitle="#{infoxMessages['searchForm.title']}">
                    <wi:inputText id="codFluxo"
                        label="#{infoxMessages['fluxo.codFluxo']}"
                        value="#{fluxoList.entity.codFluxo}" />
                    <wi:inputText id="descricao"
                        label="#{infoxMessages['fluxo.descricao']}"
                        value="#{fluxoList.entity.fluxo}" />
                </wi:searchForm>
            </ui:define>

            <ui:define name="toolBar">
                <h:form style="display:inline-block;">
                    <p:commandLink id="selectFluxo"
                        rendered="#{not empty row.svgExecucao}"
                        action="#{monitorProcessoView.selectFluxo(row)}"
                        onclick="infox.showLoading();"
                        process="@form" update=":pageBody"
                        oncomplete="infox.hideLoading();">
                        <wi:toolBarGraphicImage id="selectFluxoImage"
                            title="#{infoxMessages['monitorProcesso.fluxo.select']}"
                            url="#{layoutController.getResourceUrlByPath('/imagens/view.png')}" />
                    </p:commandLink>
                </h:form>
            </ui:define>

            <wi:columnOutputText columnId="codFluxo"
                columnHeader="#{infoxMessages['monitorProcesso.fluxo.codFluxo']}"
                value="#{row.codFluxo}" />

            <wi:columnOutputText columnId="fluxo"
                columnHeader="#{infoxMessages['monitorProcesso.fluxo.descricao']}"
                value="#{row.fluxo}" />
        </wi:dataTable>
    </ui:define>

    <ui:define name="form" />

    <ui:define name="tabs">
        <infox:tab id="monitorTab" name="monitorTab"
            title="#{infoxMessages['monitorProcesso.grafico']}"
            rendered="#{not empty monitorProcessoView.fluxo}">
            <div style="margin-top: 2em;">
                <h:outputText value="#{monitorProcessoView.svg}" escape="false" />
            </div>
        </infox:tab>
    </ui:define>
</ui:composition>
