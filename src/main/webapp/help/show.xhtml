<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:s="http://jboss.org/schema/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:wi="http://www.itx.com.br/jsf"
    xmlns:infox="http://www.infox.com.br/jsf"
>
<h:head>
    <meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8"
    />
    <title>#{messages['ajuda.titlePage']}</title>
    <h:outputStylesheet
        library="stylesheet"
        name="theme.css"
    />
    <h:outputStylesheet
        library="styleSkinInfox"
        name="padrao.css"
    />
    <link
        rel="icon"
        href="#{pathResolver.contextPath}/favicon.ico"
        type="image/x-icon"
    />
</h:head>
<h:body>
    <ui:include src="/WEB-INF/xhtml/templates/ajaxQueue.xhtml" />
    <h:outputScript
        name="JAVASERVERFACES-1718-Workaround.js"
        library="js"
        target="head"
    />
    <h:outputScript
        name="namespace.js"
        library="js"
        target="head"
    />
    <h:outputScript
        library="js"
        name="util.js"
        target="head"
    />
    <h:form>
        <a:jsFunction
            name="refreshPage"
            status="status"
            render="showHelp"
            limitRender="true"
        >
            <a:param
                name="idAjuda"
                assignTo="#{ajudaView.id}"
            />
        </a:jsFunction>
    </h:form>
    <s:div id="showHelp">
        <div class="status-ajuda">
            <a:status id="status">
                <f:facet name="start">
                    <h:graphicImage value="#{a4jSkin.imgFolder}/spinner.gif" />
                </f:facet>
            </a:status>
        </div>
        <h:form>
            <h:panelGrid columns="2">
                <h:panelGroup>
                    <h:outputLabel
                        value="#{messages['ajuda.search']} "
                        for="searchText"
                    />
                    <h:inputText
                        id="searchText"
                        value="#{ajudaView.textoPesquisa}"
                    />
                </h:panelGroup>
                <a:commandButton
                    render="resultado"
                    limitRender="true"
                    image="#{a4jSkin.imgFolder}/grid/arrow-next-off.gif"
                    oncomplete="if (#{rich:component('helpPanel')}.getItems().length &gt; 1) #{rich:component('helpPanel')}.switchToItem('search');"
                />
            </h:panelGrid>
        </h:form>
        <s:div id="resultado">
            <h:outputText
                value="#{messages['ajuda.noResult']}"
                rendered="#{empty ajudaView.resultadoPesquisa and !empty ajudaView.textoPesquisa}"
                styleClass="sem-resultado-ajuda"
            />
            <rich:tabPanel
                id="helpPanel"
                height="650px"
                switchType="client"
                activeItem="#{ajudaView.tab}"
            >
                <rich:tab
                    id="help"
                    header="#{messages['ajuda.panelHeader']}"
                    name="help"
                >
                    <s:div
                        id="helpLink"
                        styleClass="help-link"
                    >
                        <h:outputLink
                            value="#{pathResolver.contextPath}/help/show.seam?viewId=#{ajudaView.viewId}"
                        >
                            <h:graphicImage
                                url="link.gif"
                                title="#{messages['ajuda.link']}"
                            />
                        </h:outputLink>
                        <h:graphicImage
                            url="#{a4jSkin.imgFolder}/edit.gif"
                            title="#{messages['ajuda.edit']}"
                            styleClass="cursor-pointer"
                            onclick="infox.openPopUp('_blank', '#{pathResolver.contextPath}/help/edit.seam?cid=#{conversation.id}','1024');"
                        />
                    </s:div>
                    <h:outputText
                        id="helpText"
                        escape="false"
                        rendered="#{! canEdit}"
                        value="#{ajudaView.texto}"
                    />
                </rich:tab>
                <rich:tab
                    id="search"
                    rendered="#{!empty ajudaView.resultadoPesquisa and !empty ajudaView.textoPesquisa}"
                    header="#{messages['ajuda.result']}"
                    name="search"
                >
                    <h:form>
                        <h:dataTable
                            id="helpResult"
                            rendered="#{! empty ajudaView.textoPesquisa}"
                            value="#{ajudaView.resultadoPesquisa}"
                            var="v"
                        >
                            <h:column>
                                <div
                                    class="resultado-pesquisa-ajuda label-general"
                                >
                                    <a:commandLink
                                        value="#{v[0].pagina.descricao}"
                                        render="helpText, helpLink"
                                        limitRender="true"
                                        oncomplete="#{rich:component('helpPanel')}.switchToItem('help');"
                                        action="#{ajudaView.setViewId(v[0].pagina.url, false)}"
                                    >
                                        <f:param
                                            name="queryString"
                                            value="#{ajudaView.textoPesquisa}"
                                        />
                                    </a:commandLink>
                                    <div>
                                        <h:outputText
                                            value="#{v[1]}"
                                            escape="false"
                                        />
                                        <b>···</b>
                                    </div>
                                </div>
                            </h:column>
                        </h:dataTable>
                    </h:form>
                </rich:tab>
            </rich:tabPanel>
        </s:div>
    </s:div>
</h:body>
</html>