<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a="http://richfaces.org/a4j"
	  xmlns:rich="http://richfaces.org/rich"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:s="http://jboss.org/schema/seam/taglib">
<h:head>    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Ajuda</title>
    <a:loadStyle src="/stylesheet/theme.css" />
    <a:loadScript src="/js/util.js" />
	<link rel="icon" href="#{util.contextPath}/favicon.ico" type="image/x-icon" />
</h:head>

<h:body>>
	<a:form>
		<a:jsFunction name="refreshPage" status="status" reRender="showHelp" />
	</a:form>
	
	<s:div id="showHelp">
		<div style="position: absolute; right: 3px; top: 3px; z-index: 1000">
		   <a:status id="status">
		      <f:facet name="start">
	         	<h:graphicImage value="/img/spinner.gif"/>
		      </f:facet>
		   </a:status>
		</div>
		
		<a:form ajaxSubmit="true"  
				focus="searchText"
				style="position: absolute; right:5px">
			<table cellspacing="0" cellpadding="0"><tr>
				<td><span style="font-size: 11px; padding-right: 3px">Pesquisar:</span>
					<h:inputText id="searchText" 
						style="font-size: 11px; padding-left:2px" 
						value="#{ajudaHome.textoPesquisa}" />
				</td><td>
					<a:commandButton
						reRender="resultado" 
						oncomplete="if (RichFaces.panelTabs['helpPanel'].size() > 1) RichFaces.switchTab('helpPanel', 'search')"
						image="/img/grid/arrow-next-off.gif"/>
				</td>
			</tr></table>
			<f:param name="tab" value="search" />
		</a:form>
	
		<s:div id="resultado">
			<h:outputText value="Nenhum resultado encontrado."
				style="font-size: 13px; position: absolute; 
					color: red;
					right: 250px; top: 2px"
				rendered="#{empty ajudaHome.resultadoPesquisa and !empty ajudaHome.textoPesquisa}"/>
			<rich:tabPanel id="helpPanel" 
				height="650px" selectedTab="#{ajudaHome.tab}" switchType="client">
				<rich:tab id="help" label="Ajuda">
					<s:div id="helpLink" rendered="true"
						style="position:fixed; top:25px; right:5px;">
						<h:outputLink value="#{util.contextPath}/help/show.seam?viewId=#{ajudaHome.viewId}">
							<h:graphicImage url="link.gif" 
								title="Utilize esse link para fazer referência a essa página"/>
						</h:outputLink>
						<h:graphicImage url="#{a4jSkin.imgIconEdit}" 
							title="Editar conteúdo"
							style="cursor:pointer;"
							rendered="#{s:hasRole('redator')}"
							onclick="openPopUp('_blank', '#{util.contextPath}/help/edit.seam?cid=#{conversation.id}','1024');" 
							/>
					</s:div>
					<h:outputText id="helpText"
						escape="false"
						rendered="#{! canEdit}"
						value="#{ajudaHome.texto}" />
				</rich:tab>
		
				<rich:tab id="search"
					rendered="#{!empty ajudaHome.resultadoPesquisa and !empty ajudaHome.textoPesquisa}"
					label="Resultado da pesquisa">
					<a:form>
						<h:dataTable id="helpResult"
							rendered="#{! empty ajudaHome.textoPesquisa}"
							value="#{ajudaHome.resultadoPesquisa}" var="v">
							<h:column>
								<div style="margin: 1em; font-family: arial,sans-serif; font-size: 11px;">
									<a:commandLink value="#{v[0].pagina.descricao}" 
										reRender="helpText, helpLink"
										style="font-size: 13px; color:blue"
										oncomplete="RichFaces.switchTab('helpPanel', 'help')"
										action="#{ajudaHome.setViewId(v[0].pagina.url, false)}"
									>
										<f:param name="queryString" value="#{ajudaHome.textoPesquisa}" />
									</a:commandLink>
			   	                    <div>
										<h:outputText value="#{v[1]}" escape="false" />
										<b>&#183;&#183;&#183;</b>
			   	                    </div>
								</div>
							</h:column>
						</h:dataTable>	
					</a:form>
				</rich:tab>
			</rich:tabPanel>
		</s:div>
	</s:div>
</h:body>>
</html>