<?xml version="1.0" encoding="ISO-8859-1"?>

<!--
  IBPM - Ferramenta de produtividade Java
  Copyright (c) 1986-2009 Infox Tecnologia da Informação Ltda.
 
  Este programa é software livre; você pode redistribuí-lo e/ou modificá-lo 
  sob os termos da GNU GENERAL PUBLIC LICENSE (GPL) conforme publicada pela 
  Free Software Foundation; versão 2 da Licença.
  Este programa é distribuído na expectativa de que seja útil, porém, SEM 
  NENHUMA GARANTIA; nem mesmo a garantia implícita de COMERCIABILIDADE OU 
  ADEQUAÇÃO A UMA FINALIDADE ESPECÍFICA.
  
  Consulte a GNU GPL para mais detalhes.
  Você deve ter recebido uma cópia da GNU GPL junto com este programa; se não, 
  veja em http://www.gnu.org/licenses/  
-->       
                
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
			    xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:c="http://java.sun.com/jstl/core"
				xmlns:wi="http://www.itx.com.br/jsf"
			    xmlns:h="http://java.sun.com/jsf/html"
			    xmlns:a="http://richfaces.org/a4j"
			    xmlns:f="http://java.sun.com/jsf/core"
			    xmlns:s="http://jboss.com/products/seam/taglib"
			    xmlns:rich="http://richfaces.ajax4jsf.org/rich"
			    template="/WEB-INF/xhtml/templates/core/defaultTemplate.xhtml">
						    
<ui:define name="title">#{messages['localizacao.titlePage']}</ui:define>
<ui:param name="home" value="#{localizacaoHome}" />

<ui:define name="searchGrid">   
    <h:messages globalOnly="true" styleClass="message" id="globalMessages"/>
    <wi:datagrid useDatamodel="true"
		    	 datamodel="#{localizacaoHome.searchTree2GridList.list}"
		    	 bean="#{localizacaoGrid}" 
		    	 searchBean="#{localizacaoSearch}" 
		    	 title="#{messages['localizacao.titleGrid']}"
		    	 columnList="localizacao, estrutura, ativo"
		    	 headerToolBar="none"
		    	 treeMode="true"
		    	 toolBar="toolBarTree"
		    	 reRenderButtonLimpar="#{localizacaoHome.newInstance()}" />
</ui:define>

<ui:define name="form">
	<wi:form form="#{localizacaoForm}" 
	         formTitle="#{messages['localizacao.titleForm']}"
	         persistSemNewInstance="true"/>
</ui:define>

<ui:define name="tabs">
	<rich:tab label="#{messages['localizacao.itemTipoDocumentoList']}"
		      status=":status"
			  id="itemTipoDocumento"
			  action="#{itemTipoDocumentoHome.newInstance()}"
			  rendered="#{home.managed}">

		<wi:dataForm home="#{itemTipoDocumentoHome}"
					 formId="itemTipoDocumentoForm"
					 formTitle="Adicionar Grupo de Documento à Localização - #{(localizacaoHome.instance)}">
				
			<wi:suggest id="orgaoJulgador"
						bean="#{grupoModeloDocumentoSuggest}"
					    assignTo="itemTipoDocumentoHome.instance.grupoModeloDocumento"
						label="Grupo Documento"/>				
		</wi:dataForm>
		<br/>		
	  	<wi:dataTable id="itemTipoDocumentoList"
					  values="#{itemTipoDocumentoList.list(15)}" 
		              bean="#{itemTipoDocumentoList}"
					  tableTitle="Grupo Documento" 
					  rowId="#{row.idItemTipoDocumento}">
						  
			<ui:define name="toolBar">
				<a:form>
					<div style="width: 35px">
						<a:region renderRegionOnly="false">
							<a:commandLink	action="#{itemTipoDocumentoHome.remove(row)}"
											rendered="#{wi:get(canEdit,true)}"
											limitToList="true"
											status=":status"
											reRender="pageBody"
											onclick="if(!confirm('Confirma?')) return false;">
								<h:graphicImage	url="/img/remove.png" 
												title="Remover registro"
												style="opacity:0.15; #{style}"
												onmouseover="this.style.opacity=1"
												onmouseout ="this.style.opacity=0.15"/>
							</a:commandLink>
						</a:region>
					</div>
				</a:form>							
			</ui:define>
				
			<wi:columnOutputText columnId="grupoModeloDocumento"
								 columnHeader="Grupo Documento"
								 value="#{row.grupoModeloDocumento}" />
									 
		</wi:dataTable>
	</rich:tab>
	<rich:tab label="#{messages['localizacaoTurno.tabTitle']}"
		      status=":status"
			  id="localizacaoTurno"
			  action="#{localizacaoTurnoAction.init()}"
			  rendered="#{home.managed}">

		<wi:dataForm home="#{localizacaoTurnoAction}"
					 formId="localizacaoTurnoForm"
					 formTitle="Adicionar Turno à Localização - #{(localizacaoHome.instance)}">
			<wi:inputTime id="horaInicio"
						  labelTime="#{messages['localizacaoTurno.horaInicio']}"
						  required="true"
						  value="#{localizacaoTurnoAction.instance.horaInicio}"/>
		    <wi:inputTime id="horaFim"
						  labelTime="#{messages['localizacaoTurno.horaFim']}"
						  required="true"
						  value="#{localizacaoTurnoAction.instance.horaFim}"/>		
			<ui:define name="buttons">
				<wi:commandButton id="saveLocalizacaoTurnoButton"
								  action="localizacaoTurnoAction.persist"
								  reRender="localizacaoTurnoForm, localizacaoTurnoDiv"
								  value="Incluir"/>
			</ui:define>					
		</wi:dataForm>
		<br/>		
	  	<s:div id="localizacaoTurnoDiv">
	  		<h:form>
		  		<rich:dataTable id="localizacaoTurnoTable"
								value="#{localizacaoTurnoAction.localizacaoTurnoList}"
								var="row"
								title="Turno à Localização - #{(localizacaoHome.instance)}"
								rows="10"
								style="width: 50%">
					<rich:column style="width: 10%">
						<f:facet name="header">
							<wi:toolBarRemove id="headerRemoveLocalizacaoTurno"
											  reRender="localizacaoTurnoDiv"
										      actionRemove="localizacaoTurnoAction.removeAll()"
										      title="Remover todos os Registros"/>
						</f:facet>
						<center>
							<wi:toolBarRemove id="toolBarRemoveLocalizacaoTurn"
											  reRender="localizacaoTurnoDiv"
										      actionRemove="localizacaoTurnoAction.remove(row)"/>
						</center>
					</rich:column>
					<rich:column style="width: 45%">
						<f:facet name="header">
							<h:outputText value="#{messages['localizacaoTurno.horaInicio']}" />
						</f:facet>
						<h:outputText value="#{row.horaInicio}">
							<s:convertDateTime pattern="kk:mm"/>
						</h:outputText>
					</rich:column>
					<rich:column style="width: 45%">
						<f:facet name="header">
							<h:outputText value="#{messages['localizacaoTurno.horaFim']}" />
						</f:facet>
						<h:outputText value="#{row.horaFim}">
							<s:convertDateTime pattern="kk:mm"/>
						</h:outputText>
					</rich:column>
				</rich:dataTable>
				<rich:datascroller id="dsLocalizacaoTurnoTable"
								   for="localizacaoTurnoTable"
								   lastPageMode="full"
								   align="left"
								   renderIfSinglePage="false"/>
			</h:form>
	  	</s:div>
	</rich:tab>
</ui:define> 
 
</ui:composition>