<?xml version="1.0" encoding="ISO-8859-1"?>

<!-- $Id: listView.xhtml 750 2010-08-24 14:10:58Z danielsilva $ -->


<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:s="http://jboss.com/products/seam/taglib"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:c="http://java.sun.com/jstl/core"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:wi="http://www.itx.com.br/jsf"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:a="http://richfaces.org/a4j"
				xmlns:rich="http://richfaces.ajax4jsf.org/rich"
				template="/WEB-INF/xhtml/templates/core/menuTemplate.xhtml">
                       
	<ui:define name="title">#{messages['processo.titlePage']}</ui:define>
	
	<ui:param name="action" value="#{iniciarProcessoAction}"/>
	
	<ui:define name="body">
		<rich:spacer height="5%"/>
		<wi:dataForm formId="iniciarProcesso"
					 formTitle="#{messages['processo.titleFormIniciarProcesso']}"
					 renderRegionOnly="true">
			<rich:dataTable id="natCatFluxoTable"
							value="#{action.naturezaCategoriaFluxoList}"
							var="row"
							rows="10"
							style="width: 60%">
				<rich:column style="width: 10%">
					<a:commandLink action="#{action.onSelectNatCatFluxo(row)}"
	                			   ajaxSingle="true"
	                               reRender="assuntoLocalizacaoDiv">
	                    <h:graphicImage url="/img/start.gif"/>
	                </a:commandLink>
				</rich:column>
				<rich:column style="width: 30%">
					<f:facet name="header">
						<h:outputText value="#{messages['naturezaCategoriaFluxo.natureza']}" />
					</f:facet>
					<h:outputText value="#{row.natureza}"/>
				</rich:column>
				<rich:column style="width: 30%">
					<f:facet name="header">
						<h:outputText value="#{messages['naturezaCategoriaFluxo.categoria']}" />
					</f:facet>
					<h:outputText value="#{row.categoria}"/>
				</rich:column>
				<rich:column style="width: 30%">
					<f:facet name="header">
						<h:outputText value="#{messages['naturezaCategoriaFluxo.fluxo']}" />
					</f:facet>
					<h:outputText value="#{row.fluxo}"/>
				</rich:column>
			</rich:dataTable>
			<rich:datascroller for="natCatFluxoTable"
							   lastPageMode="full"
							   id="dsNatCatFluxoTable"
							   align="left"
							   renderIfSinglePage="false"/>
			<br/>
			<s:div id="assuntoLocalizacaoDiv">
				<rich:dataTable id="assuntoTable"
								value="#{action.assuntoList}"
								var="row"
								rows="10"
								rendered="#{action.renderedAssuntoLocalizacao}"
								style="width: 20%">
					<rich:column style="width: 20%">
						<h:selectBooleanCheckbox id="checked"
												 value="#{row.checked}">
							<a:support event="onchange"
									   action="#{action.onSelectAssunto()}"
									   ajaxSingle="true"
									   reRender="renderedButtons"/>
						</h:selectBooleanCheckbox>
					</rich:column>
					<rich:column style="width: 80%">
						<f:facet name="header">
							<h:outputText value="#{messages['assunto.assunto']}" />
						</f:facet>
						<h:outputText value="#{row.assunto}"/>
					</rich:column>
				</rich:dataTable>
				<rich:datascroller for="assuntoTable"
								   lastPageMode="full"
								   id="dsAssuntoTable"
								   align="right"
								   renderIfSinglePage="false"/>
				<wi:selectOneMenuEntity id="localizacaoCombo"
									    label="#{messages['localizacao.localizacao']}"
										value="#{action.localizacao}"
										rendered="#{action.renderedAssuntoLocalizacao}"
										noSelectionLabel="Selecione um registro..."
										items="#{action.localizacaoList}">
					<a:support event="onchange"
							   action="#{action.onSelectLocalizacao()}"
							   ajaxSingle="true"
							   reRender="renderedButtons"/>
				</wi:selectOneMenuEntity>
			</s:div>
			<ui:define name="buttons">
				<s:div id="renderedButtons">
					<wi:commandButton id="iniciarProcessoButton"
									  value="Iniciar Processo"
									  rendered="#{action.renderedByAssunto and action.renderedByLocalizacao}"
									  action="iniciarProcessoAction.iniciarProcesso()"
									  oncomplete="window.open('#{util.contextPath}/Processo/movimentar.seam?idProcesso=#{action.processoEpa.idProcesso}', '#{processoHome.instance.idProcesso}popUpFluxo', 'fullscreen=1, resizable=yes,scrollbars=1'); 
									  			  window.location='#{util.contextPath}/Painel/list.seam';"/>
				</s:div>
			</ui:define>
		</wi:dataForm>
	</ui:define>

</ui:composition>