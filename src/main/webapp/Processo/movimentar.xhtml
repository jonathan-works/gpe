<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:s="http://jboss.org/schema/seam/taglib"
	xmlns:wi="http://www.itx.com.br/jsf"
	xmlns:infox="http://www.infox.com.br/jsf"
    template="/WEB-INF/xhtml/templates/minimal.xhtml">
	

    <!--
	  IBPM - Ferramenta de produtividade Java
	  Copyright (c) 1986-2009 Infox Tecnologia da Informação Ltda.
	 
	  Este programa é software livre; você pode redistribuí-lo e/ou modificá-lo 
	  sob os termos da GNU GENERAL PUBLIC LICENSE (GPL) conforme publicada pela 
	  Free Software Foundation; versão 2 da Licença.
	  Este programa é distribuído na expectativa de que seja útil, porém, SEM 
	  NENHUMA GARANTIA; nem mesmo a garantia implícita de COMERCIABILIDADE OU 
	  ADEQUAÇÃO A UMA FINALIDADE ESPECÍFICA.
	  
	  Consulte a GNU GPL para mais detalhes.
	  Você deve ter recebido uma cópia da GNU GPL junto com este programa; se não, 
	  veja em http://www.gnu.org/licenses/  
	-->

    <ui:param
		 name="pageTitle"
		 value="#{messages['processo.titlePage']}" />
    <ui:define name="title">#{pageTitle}</ui:define>

    <ui:param
		 name="home"
		 value="#{processoHome}" />
    <ui:param
		 name="showMenu"
		 value="false" />
    <ui:param
		 name="checkPermission"
		 value="#{processoHome.checarVisibilidade()}" />
	<ui:define name="head">
		<h:outputStylesheet
	        library="styleSkinInfox"
	        name="movimentar.css" />
	</ui:define>
    <ui:define name="body">
		
        <s:div id="script">
			
            <f:verbatim>
				
                <script type="text/javascript">
		    	function verifyFields() { 
		        	if("#{util.getFromEventContext('taskCompleted')}" != '') {
			        	try {
		        			opener.atualizaPainelFluxo();
			        	} catch(e) {}
			        	if("#{util.getFromEventContext('canClosePanel')}" != '') {
			        		window.close();
			        	} else {
			        		location = location.href;
			        	}
		        	} else {
		        		namespace.infox.hideLoading();
		        	}
		    	}
		    </script>
            
			</f:verbatim>
        
		</s:div>

        <h:form>
			
            <a:jsFunction
				 name="renderButtons"
				 render="taskButtonsDiv" />
        
		</h:form>
			
            <infox:tabPanel
				 switchType="ajax"
				 rendered="#{checkPermission}"
				 activeTab="#{home.tab}">
				<h:form><infox:tabHeaders /></h:form>

                <infox:tab
					 id="tabFluxo"
					 name="tabFluxo"
					 rendered="#{!processoHome.managed}"
					 status=":status"
					 title="Escolher fluxo"
                     action="#{processoHome.limpar()}">
					
                    <h:messages
						 id="globalMessages"
						 globalOnly="true"
						 styleClass="message" />
                
				</infox:tab>

                <infox:tab
					 id="tabEntrada"
					 name="tabEntrada"
					 rendered="#{!empty taskInstanceView.fields}"
					 status=":status"
					 title="Entrada">
					
                    <ui:decorate
							id="frameDecorate"
							template="../WEB-INF/xhtml/templates/core/include/frame.xhtml">
						<ui:define name="title">Entrada</ui:define>
                        <wi:form
							 canEdit="true"
							 formTitle="#{taskInstance.name}"
							 home="#{taskInstanceHome}"
							 form="#{taskInstanceView}" />
                    
					</ui:decorate>
                
				</infox:tab>

                <infox:tab
					 id="tabSaida"
					 name="tabSaida"
					 rendered="#{processoHome.managed}"
					 status=":status"
					 title="Saída">
					
                    <c:if test="#{empty taskPageAction.taskPagePath}">
						<ui:decorate
							id="frameDecorate"
							template="../WEB-INF/xhtml/templates/core/include/frame.xhtml">
							<ui:define name="title">Saída</ui:define>
                            <wi:form
								 canEdit="true"
								 formTitle="#{taskInstance.name}"
								 home="#{taskInstanceForm.home}"
								 reRenderSave="taskInstanceDiv"
								 form="#{taskInstaceForm}" />
	                        
						</ui:decorate>
                    
					</c:if>
                    <c:if test="#{not empty taskPageAction.taskPagePath}">
						
                        <ui:include src="#{taskPageAction.taskPagePath}" />
                    
					</c:if>
                
				</infox:tab>

                <infox:tab
					 id="tabAnexar"
					 name="tabAnexar"
					 rendered="#{processoHome.managed}"
					 status=":status"
					 title="Anexar Documento"
                     action="#{processoDocumentoHome.newInstance()}">
					
                    <ui:decorate
							id="frameDecorate"
							template="../WEB-INF/xhtml/templates/core/include/frame.xhtml">
							<ui:define name="title">Anexar Documento</ui:define>
                            <wi:dataForm
								 formId="anexarDocumentosForm"
								 formTitle="#{messages['processoDocumento.anexarDocumento']}">
								
                                <ui:include src="/WEB-INF/xhtml/components/form/anexarDocumento.xhtml" />
                                <ui:include src="/WEB-INF/xhtml/components/form/buttons/anexarDocumentoButtons.xhtml" />
                                <ui:define name="buttons" />
                            
							</wi:dataForm>
                        
					</ui:decorate>
                
				</infox:tab>

                <infox:tab
					 id="tabAnexos"
					 name="tabAnexos"
					 rendered="#{processoHome.managed}"
					 status=":status"
					 title="Documentos do Processo">
                    <ui:decorate
							id="frameDecorate"
							template="../WEB-INF/xhtml/templates/core/include/frame.xhtml">
						<ui:define name="title">Documentos do Processo</ui:define>
						
                        <wi:dataTable
							 values="#{processoDocumentoList.list(15)}"
							 bean="#{processoDocumentoList}"
							 tableTitle="#{messages['processo.documentos']} #{home.instance}"
							 id="processoDocumentoList"
							 rowId="#{row.idProcessoDocumento}"
							 searchFormStyleClass="hidden">
							
                            <ui:define name="headerToolBar" />
                            <wi:columnOutputText
								 columnId="usuarioInclusao"
								 columnHeader="#{messages['processoDocumento.usuarioInclusao']}"
								 value="#{row.usuarioInclusao}" />
                            <wi:columnDateTime
								 columnId="dataInclusao"
								 columnHeader="#{messages['processoDocumento.dataInclusao']}"
								 value="#{row.dataInclusao}" />
                            <wi:columnOutputText
								 columnId="processoDocumentoBin"
								 columnHeader="#{messages['processoDocumentoBin.documento']}"
								 value="#{row.processoDocumentoBin}" />
                            <ui:define name="toolBar" />
                        
						</wi:dataTable>
                    
					</ui:decorate>
                
				</infox:tab>

                <infox:tab
					 id="tabMovimentacoes"
					 name="tabMovimentacoes"
					 rendered="#{processoHome.managed}"
					 status=":status"
					 title="Movimentações do Processo">
					<ui:decorate
							id="frameDecorate"
							template="../WEB-INF/xhtml/templates/core/include/frame.xhtml">
						<ui:define name="title">Movimentações do Processo</ui:define>
                    	<ui:include src="/WEB-INF/xhtml/components/grid/movimentacoesProcessoGrid.xhtml" />
                    </ui:decorate>
                
				</infox:tab>

                <ui:param
					 name="action"
					 value="#{localizacaoDocumentoFisicoAction}" />
                <infox:tab
					 id="documentoFisicoTab"
					 name="documentoFisicoTab"
					 rendered="#{home.isManaged()}"
					 title="#{messages['documentoFisico.titleTab']}"
                     action="#{localizacaoDocumentoFisicoAction.init()}">
					<ui:decorate
							id="frameDecorate"
							template="../WEB-INF/xhtml/templates/core/include/frame.xhtml">
						<ui:define name="title">#{messages['documentoFisico.titleTab']}</ui:define>
	                    <wi:dataForm
							 formId="documentoFisicoForm"
							 formTitle="#{messages['form.title']}">
							
	                        <wi:tree
								 id="localizacaoFisica"
								 assignTo="localizacaoDocumentoFisicoAction.instance.localizacaoFisica"
								 tree="#{localizacaoFisicaTree}"
								 label="#{messages['documentoFisico.localizacaoFisica']}"
								 required="true"
								 noSelectionLabel="#{messages['documentoFisico.selectLocalizacaoFisica']}" />
	
	                        <wi:inputText
								 id="descricaoDocumentoFisico"
								 label="#{messages['documentoFisico.descricaoDocumentoFisico']}"
								 required="true"
								 value="#{action.instance.descricaoDocumentoFisico}"
								 maxlength="150" />
	                        <ui:define name="buttons">
								
	                            <wi:commandButton
									 id="saveDocumentoFisicoButton"
									 action="localizacaoDocumentoFisicoAction.save"
									 reRender="documentoFisicoForm, documentoFisicoDiv"
									 value="Incluir" />
	                        
							</ui:define>
	                    
						</wi:dataForm>
	                    <s:div id="documentoFisicoDiv">
							<wi:dataTable
								id="documentoFisicoTable2"
								values="#{localizacaoDocumentoFisicoAction.documentoFisicoList}"
								var="row"
								rows="10"
								searchFormStyleClass="hidden">
								<ui:define name="toolBar">
									<wi:toolBarRemove
										id="toolBarInactivate"
										reRender="documentoFisicoDiv"
										actionRemove="localizacaoDocumentoFisicoAction.inactive(row)"
										/>
								</ui:define>
								<ui:define name="headerToolBar">
									<wi:toolBarRemove
										id="headerInactivate"
										reRender="documentoFisicoDiv"
										actionRemove="localizacaoDocumentoFisicoAction.inactiveAll()"
										title="Inativar todos os Registros" />
								</ui:define>
								<wi:columnOutputText
									columnId="localizacaoFisica"
									columnHeader="#{messages['documentoFisico.localizacaoFisica']}"
									value="#{row.localizacaoFisica.caminhoCompletoToString()}"
									hideOrder="true"
									/>
								<wi:columnOutputText
									columnId="descricao"
									columnHeader="#{messages['documentoFisico.descricaoDocumentoFisico']}"
									value="#{row.descricaoDocumentoFisico}"
									hideOrder="true"
									/>
							</wi:dataTable>
						</s:div>
					</ui:decorate>
                
				</infox:tab>

                <infox:tab
					 id="tabPartesDoProcesso"
					 name="tabPartesDoProcesso"
					 status=":status"
					 rendered="#{home.hasPartes()}"
					 title="#{messages['parteProcesso.partes']}">
					<ui:decorate
							id="frameDecorate"
							template="../WEB-INF/xhtml/templates/core/include/frame.xhtml">
						<ui:define name="title">#{messages['parteProcesso.partes']}</ui:define>
                    	<ui:include src="parteProcessoGrid.xhtml" />
                    </ui:decorate>
                
				</infox:tab>
            
			</infox:tabPanel>
        
        <c:if test="#{!checkPermission}">
			
            <wi:outputText
				 id="error"
				 value="#{messages['movimentar.noPermission']}" />
        
		</c:if>
    
	</ui:define>



</ui:composition>
