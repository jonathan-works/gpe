<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:s="http://jboss.org/schema/seam/taglib"
    xmlns:wi="http://www.itx.com.br/jsf">

    <wi:dataForm formId="participanteFormInclude" 
		rendered="#{participantesController.podeAdicionarAlgumTipoDeParte()}"
		formTitle="Incluir Participante">
           
        <wi:selectOneRadioEnum id="radioTipoPessoa"
           	label="#{infoxMessages['pessoa.tipoPessoa']}" required="true" 
           	items="#{participantesController.tipoPessoaValues}"
           	value="#{participantesController.tipoPessoa}" 
           	rendered="#{participantesController.podeAdicionarAmbosTiposDeParte()}">
           	<a:ajax event="change" render="loadedByParticipante" immediate="true" 
           		limitRender="true" execute="@this"/>
        </wi:selectOneRadioEnum>
          
        <h:panelGroup id="loadedByParticipante" rendered="#{not empty participantesController.tipoPessoa}">
          		
       		<wi:inputCpf id="cpf"
                value="#{participantesController.participanteProcesso.pessoa.cpf}"
                label="#{infoxMessages['pessoaFisica.cpf']}"
                assignTo="participantesController.participanteProcesso.pessoa.cpf"
                required="true" rendered="#{participantesController.tipoPessoa eq 'F'}">
                <a:ajax event="blur"
                    listener="#{participantesController.searchByCpf()}"
                    execute="@this" render="nome, email, dataNascimento" limitRender="true"/> 
            </wi:inputCpf>
            
            <wi:inputCnpj id="cnpj"
                value="#{participantesController.participanteProcesso.pessoa.cnpj}"
                label="#{infoxMessages['pessoaJuridica.cnpj']}"
                assignTo="participantesController.participanteProcesso.pessoa.cnpj"
                required="true" rendered="#{participantesController.tipoPessoa eq 'J'}">
                <a:ajax event="blur" execute="@this" render="nome, razao"
                	limitRender="true" listener="#{participantesController.searchByCnpj()}" />
            </wi:inputCnpj>
            
            <wi:inputText id="nome"
                value="#{participantesController.participanteProcesso.pessoa.nome}"
                label="#{participantesController.tipoPessoa eq 'F' ? infoxMessages['pessoaFisica.nome'] : infoxMessages['pessoaJuridica.nomeFantasia']}" 
                required="true" />
             
            <wi:inputEmail id="email"
            	value="#{participantesController.email}"
            	label="#{infoxMessages['pessoaFisica.email']}" 
            	rendered="#{participantesController.tipoPessoa eq 'F'}" 
            	required="false"/>
            	
            <wi:inputText id="razao"
                value="#{participantesController.participanteProcesso.pessoa.razaoSocial}"
                label="#{infoxMessages['pessoaJuridica.razaoSocial']}" required="true" 
                rendered="#{participantesController.tipoPessoa eq 'J'}" />
                
            <wi:inputDate id="dataNascimento"
                value="#{participantesController.participanteProcesso.pessoa.dataNascimento}"
                label="#{infoxMessages['pessoaFisica.dataNascimento']}" 
                rendered="#{participantesController.tipoPessoa eq 'F'}"
                required="false" />
                
            <wi:selectOneMenuEntity id="tipoPartes"
				items="#{participantesController.tipoPartes}"
				value="#{participantesController.participanteProcesso.tipoParte}"
				label="#{infoxMessages['participanteProcesso.tipoParticipante']}"
				required="true" showLabelSelecione="true" />
				
			<wi:tree id="participanteSuperior"
                label="#{infoxMessages['participanteProcesso.superior']}"
                assignTo="participantesController.participanteProcesso.participantePai"
                tree="#{participanteProcessoTree}" />
				
			<wi:inputDate id="dataInicio"
				value="#{participantesController.participanteProcesso.dataInicio}"
				label="#{infoxMessages['participanteProcesso.dataInicioParticipacao']}"
				required="false" />
					
			<wi:inputDate id="dataFim"
				value="#{participantesController.participanteProcesso.dataFim}"
				label="#{infoxMessages['participanteProcesso.dataFimParticipacao']}" 
				required="false"/>
        </h:panelGroup>
        
        <ui:define name="buttons">
	        <wi:commandButton id="saveButton"
	            action="#{participantesController.includeParticipanteProcesso()}"
	            reRender="buscaDiv, pessoasListDiv, storeDiv, pageBodyDialogMessage"
	            value="#{infoxMessages['crud.persist']}" execute="@form"/>
        </ui:define>
           
    </wi:dataForm>
    <br />
</ui:composition>
