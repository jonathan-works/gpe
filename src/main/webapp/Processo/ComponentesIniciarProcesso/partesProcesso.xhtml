<?xml version="1.0" encoding="ISO-8859-1"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:wi= "http://www.itx.com.br/jsf"
    xmlns:s="http://jboss.org/schema/seam/taglib"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j">
    
    <ui:param name="home" value="#{pessoaHome}"/>
    
    <h:form id="partesForm">
   		<s:div id="partesDiv" rendered="#{action.renderizarCadastroPartes}">
   			<wi:selectOneRadioEnum id="tipoPessoaEnum"
								   items="#{home.getTipoPessoaItens()}"
								   value="#{home.tipoPessoa}"
								   label="#{messages['pessoa.tipoPessoa']}">
								   <a:support ajaxSingle="true"
					   					reRender="buscaDiv"
					   					event="onchange" />
			</wi:selectOneRadioEnum> 
   		</s:div>
   	</h:form>
 		<s:div id="buscaDiv">
 			<c:if test="#{home.isPessoaFisica()}">
 				<ui:include src="includePessoaFisica.xhtml"/>
 			</c:if>
 			<c:if test="#{home.isPessoaJuridica()}">
 				<ui:include src="includePessoaJuridica.xhtml"/>
 			</c:if>
 		</s:div>
    	<s:div id="pessoasListDiv" >
			<h:form>
				<s:div id="pessoasFisicasListDiv">
					<rich:dataTable id="pessoasFisicasTable"
									value="#{action.pessoaFisicaList}"
									var="row"
									rows="10"
									style="width: 60%"
									rendered="#{!action.pessoaFisicaList.isEmpty()}">
						<f:facet name="header">
							<h:outputText value="Partes - Pessoas Fisicas"/>
						</f:facet>		
						<rich:column style="width: 10%">
							<f:facet name="header"/>
							<center>
								<wi:toolBarRemove id="toolBarRemove"
												  reRender="pessoasFisicasListDiv, storeDiv"
											      actionRemove="#{action.removePessoaFisica(row)}"/>
							</center>
						</rich:column>
						<rich:column style="width: 45%">
							<f:facet name="header">
								<h:outputText value="#{messages['pessoaFisica.nome']}" />
							</f:facet>
							<h:outputText value="#{row.nome}"/>
						</rich:column>
						<rich:column style="width: 45%">
							<f:facet name="header">
								<h:outputText value="#{messages['pessoaFisica.cpf']}" />
							</f:facet>
							<h:outputText value="#{row.cpf}"/>
						</rich:column>
					</rich:dataTable>
					<rich:datascroller for="pessoasFisicasTable"
									   lastPageMode="full"
									   id="dsPessoasFisicasTable"
									   align="left"
									   renderIfSinglePage="false"/>
					<br/>				   
				</s:div>
			    <s:div id="pessoasJuridicasListDiv">
					<rich:dataTable id="pessoasJuridicasTable"
									value="#{action.pessoaJuridicaList}"
									var="row"
									rows="10"
									style="width: 60%"
									rendered="#{!action.pessoaJuridicaList.isEmpty()}">
						<f:facet name="header">
							<h:outputText value="Partes - Pessoas Juridicas"/>
						</f:facet>		
						<rich:column style="width: 10%">
							<f:facet name="header"/>
							<center>
								<wi:toolBarRemove id="toolBarRemove"
												  reRender="pessoasJuridicasListDiv, storeDiv"
											      actionRemove="#{action.removePessoaJuridica(row)}"/>
							</center>
						</rich:column>
						<rich:column style="width: 45%">
							<f:facet name="header">
								<h:outputText value="#{messages['pessoaJuridica.nome']}" />
							</f:facet>
							<h:outputText value="#{row.nome}"/>
						</rich:column>
						<rich:column style="width: 45%">
							<f:facet name="header">
								<h:outputText value="#{messages['pessoaJuridica.cnpj']}" />
							</f:facet>
							<h:outputText value="#{row.cnpj}"/>
						</rich:column>
					</rich:dataTable>
					<rich:datascroller for="pessoasJuridicasTable"
									   lastPageMode="full"
									   id="dsPessoasJuridicasTable"
									   align="left"
									   renderIfSinglePage="false"/>
				</s:div>
				<s:div id="storeDiv">
					<wi:commandButton id="storeButton"
								  action="#{action.iniciarProcesso()}"
								  rendered="#{!action.pessoaFisicaList.isEmpty() || !action.pessoaJuridicaList.isEmpty()}"
								  reRender="includePessoaFisicaDiv, pessoasFisicasListDiv"
								  value="Iniciar Processo"
								  oncomplete="window.open('#{util.contextPath}/Processo/movimentar.seam?idProcesso=#{action.processoEpa.idProcesso}', '#{processoHome.instance.idProcesso}popUpFluxo', 'fullscreen=1, resizable=yes,scrollbars=1'); 
								  			  window.location='#{util.contextPath}/Painel/list.seam';"/>
				</s:div>
		</h:form>
	</s:div>
</ui:composition>