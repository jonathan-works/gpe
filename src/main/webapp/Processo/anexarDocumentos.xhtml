<?xml version="1.0" encoding="UTF-8"?>
<ui:composition
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:s="http://jboss.org/schema/seam/taglib"
  xmlns:wi="http://www.itx.com.br/jsf"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:a="http://richfaces.org/a4j">
  <rich:collapsiblePanel
    switchType="client"
    expanded="false"
    header="#{messages['documentoEditor.header']}">
    <s:div id="editorDiv">
      <s:div>
        <wi:inputText
          id="#{f.id}inputProcessoDocumento"
          value="#{documentoEditor.processoDocumento.processoDocumento}"
          disabled="false"
          required="true"
          label="#{messages['processo.anexarDocumentoDescricao']}">
        </wi:inputText>
        <wi:selectOneMenuEntity
          id="#{f.id}tipoProcessoDocumento"
          label="#{messages['tipoProcessoDocumento.tipoProcessoDocumento']}"
          value="#{documentoEditor.processoDocumento.tipoProcessoDocumento}"
          items="#{classificacaoDocumentoFacade.getUseableTipoProcessoDocumento(false)}"
          required="true"
          showLabelSelecione="true">
          <a:ajax event="change" status=":status" limitRender="true" 
          		  render=":movimentarTabPanel:anexarDocumentosForm:editorToolTipDiv" execute="@this"/>
        </wi:selectOneMenuEntity>
      </s:div>
      <s:div id="tipoDocumentoDiv">
      	<s:div id="editorToolTipDiv" styleClass="tooltip-parent" style="width: 10px" 
		  	rendered="true">
		  	<h:graphicImage id="#{id}helpEditTipImg" url="#{a4jSkin.imgFolder}/help.gif" />
			<div class="epp-tooltip">
				<div class="tooltip-panel">
					<div><h:outputText value="Observação:"/></div>
					<h:outputText value="#{documentoEditor.processoDocumento.tipoProcessoDocumento.tipoProcessoDocumentoObservacao}"/>
				</div>
			</div>
	    </s:div>
        <wi:editor
          id="modeloDocumento"
          label="#{messages['tipoProcessoDocumento.modelo']}"
          value="#{documentoEditor.processoDocumento.processoDocumentoBin.modeloDocumento}"
          requiredField="false"
          required="true"
          showVariables="false">
        </wi:editor>
      </s:div>
      <s:div id="buttonsDiv">
        <wi:commandButton
          id="botaoAnexarDocumento"
          action="documentoEditor.persist()"
          value="#{messages['processo.anexarDocumentoBtn']}"
          execute="editorDiv"
          reRender="@form,pageBodyDialogMessage, buttonsDiv"
          styleClass="buttons">
        </wi:commandButton>
      </s:div>
    </s:div>
  </rich:collapsiblePanel>
  <br />
  <rich:collapsiblePanel
    switchType="client"
    expanded="true"
    header="#{messages['fileUpload.header']}">
    <s:div id="uploaderDiv">
      <div>
        <wi:inputText
          id="inputProcessoDocumentoPdf"
          value="#{documentoUploader.processoDocumento.processoDocumento}"
          disabled="false"
          required="true"
          label="#{messages['processo.anexarDocumentoDescricao']}">
          <a:ajax
            event="change"
            limitRender="true"
            status=":status"
            onbeforesubmit="infox.showLoading();"
            oncomplete="infox.hideLoading();"
            listener="#{documentoUploader.podeRenderizar}"
            execute="@this" />
        </wi:inputText>
        <wi:selectOneMenuEntity
          id="tipoProcessoDocumentoPdf"
          label="#{messages['tipoProcessoDocumento.tipoProcessoDocumento']}"
          value="#{documentoUploader.tipoProcessoDocumento}"
          items="#{classificacaoDocumentoFacade.getUseableTipoProcessoDocumento(false)}"
          required="true"
          showLabelSelecione="true">
          <a:ajax
            event="change"
            onbeforesubmit="infox.showLoading();"
            oncomplete="infox.hideLoading();"
            limitRender="true"
            render="tipoDocumentoDivPdf buttonsPdfDiv"
            listener="#{documentoUploader.onChangeClassificacaoDocumento}"
            status=":status"
            execute="@this" />
        </wi:selectOneMenuEntity>
      </div>
      <s:div id="tipoDocumentoDivPdf">
        <wi:fileUpload
          id="uploadArquivo"
          label="#{messages['fileUpload.type.file']}"
          reRender="buttonsPdfDiv #{f.id}tipoProcessoDocumentoPdf"
          rendered="#{not empty documentoUploader.tipoProcessoDocumento and not empty documentoUploader.tipoProcessoDocumento.extensaoArquivosList and not empty documentoUploader.processoDocumento.processoDocumento}"
          accept="#{documentoUploader.processoDocumento.tipoProcessoDocumento.acceptedTypes}">
        </wi:fileUpload>
      </s:div>
      <s:div id="buttonsPdfDiv">
        <wi:commandButton
          id="botaoAnexarDocumentoPdf"
          action="documentoUploader.persist()"
          value="#{messages['processo.anexarDocumentoBtn']}"
          execute="#{f.id}inputProcessoDocumentoPdf, #{f.id}tipoProcessoDocumentoPdf"
          reRender="@form"
          styleClass="buttons"
          rendered="#{documentoUploader.valido}">
        </wi:commandButton>
      </s:div>
    </s:div>
  </rich:collapsiblePanel>
  <br />
  <s:div id="documentosRedigidosDaSessao">
    <wi:dataTable
      values="#{documentoEditor.documentosDaSessao}"
      tableTitle="#{messages['documentoEditor.titleView']}"
      id="processoDocumentoDaSessao"
      rowId="#{row.idProcessoDocumento}"
      showSearchForm="false"
      panelStyleClass="full-sized"
      showToolbarColumn="false">
      <wi:columnOutputText
        columnId="usuarioInclusao"
        columnHeader="#{messages['processoDocumento.usuarioInclusao']}"
        hideOrder="true"
        value="#{row.usuarioInclusao}" />
      <wi:columnDateTime
        columnId="dataInclusao"
        columnHeader="#{messages['processoDocumento.dataInclusao']}"
        hideOrder="true"
        value="#{row.dataInclusao}" />
      <wi:columnOutputText
        columnId="processoDocumento"
        columnHeader="#{messages['processoDocumentoBin.documento']}"
        hideOrder="true"
        value="#{row.processoDocumento}" />
      <ui:define name="headerToolBar" />
      <ui:define name="toolBar" />
    </wi:dataTable>
  </s:div>
  <br />
  <s:div id="documentosDaSessao">
    <wi:dataTable
      showSearchForm="false"
      values="#{documentoUploader.documentosDaSessao}"
      tableTitle="#{messages['documentoUploader.titleView']}"
      id="documentoDaSessao"
      rowId="#{row.idProcessoDocumento}"
      panelStyleClass="full-sized"
      showToolbarColumn="false">
      <wi:columnOutputText
        columnId="usuarioInclusao"
        columnHeader="#{messages['processoDocumento.usuarioInclusao']}"
        hideOrder="true"
        value="#{row.usuarioInclusao}" />
      <wi:columnDateTime
        columnId="dataInclusao"
        columnHeader="#{messages['processoDocumento.dataInclusao']}"
        hideOrder="true"
        value="#{row.dataInclusao}" />
      <wi:columnOutputText
        columnId="processoDocumento"
        columnHeader="#{messages['processoDocumentoBin.documento']}"
        hideOrder="true"
        value="#{row.processoDocumento}" />
      <ui:define name="headerToolBar" />
      <ui:define name="toolBar" />
    </wi:dataTable>
  </s:div>
</ui:composition>