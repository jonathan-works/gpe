<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:s="http://jboss.org/schema/seam/taglib"
	xmlns:wi="http://www.itx.com.br/jsf"
	xmlns:infox="http://www.infox.com.br/jsf">
	
    <s:div id="painelProcessosComunicacaoEletronica" style="width: 100%; margin-left: 0.6em;" >
        <s:div id="processosComunicacaoRecebidas" 
            rendered="#{not empty painelUsuarioController.processoIdList or not empty painelUsuarioController.idCaixa}" >

            <wi:dataTable values="#{consultaProcessoList.list(10)}" bean="#{consultaProcessoList}"
                styleClass="p-list-dtable" tableTitle="#{infoxMessages['consultaProcesso.processos']}"
                id="consultaProcessoComunicacaoRecebidasList" rowId="#{row.idProcesso}"
                searchFormStyleClass="p-list-search" panelStyleClass="p-list-panel" hideOrder="true">
        
                <ui:define name="searchForm">
                    <wi:searchForm opened="false" formId="consultaProcessoComunicacaoRecebidasForm"
                        formTitle="#{infoxMessages['searchForm.title']}" searchReRender="painelProcessosComunicacaoEletronica"
                        clearAction="consultaProcessoList.newInstance()" clearReRender="painelProcessosComunicacaoEletronica">
                        <wi:inputText
                          id="numeroProcessoRoot"
                          label="#{infoxMessages['consultaProcesso.numeroProcesso']}"
                          value="#{consultaProcessoList.numeroProcessoRoot}" />
                          
                        <wi:inputDataPeriodo
                          id="periodo"
                          label="#{infoxMessages['data.inputPeriodo']}"
                          valueDateFrom="#{consultaProcessoList.entity.dataInicio}"
                          valueDateTo="#{consultaProcessoList.dataFim}" />

						<wi:selectOneMenuEntity id="natureza" label="#{infoxMessages['natureza.tableTitle']}"
							value="#{consultaProcessoList.entity.naturezaCategoriaFluxo.natureza}" showLabelSelecione="true"
							items="#{naturezaCategoriaFluxoFacade.getNaturezaList()}">
							<a:ajax execute="@this" render="natureza categoriaOutPutPanel"
								listener="#{naturezaCategoriaFluxoFacade.loadCategoriaList(consultaProcessoList.entity.naturezaCategoriaFluxo.natureza)}"></a:ajax>
						</wi:selectOneMenuEntity>

						<a:outputPanel id="categoriaOutPutPanel">

							<wi:selectOneMenuEntity disabled="#{empty consultaProcessoList.entity.naturezaCategoriaFluxo.natureza}"
								id="categoria" label="#{infoxMessages['categoria.tableTitle']}"
								value="#{consultaProcessoList.entity.naturezaCategoriaFluxo.categoria}" showLabelSelecione="true"
								inNewLine="true" items="#{naturezaCategoriaFluxoFacade.getCategoriaList()}" />
						</a:outputPanel>
					</wi:searchForm>
                </ui:define>
    
                <wi:columnOutputText
                  columnId="numeroProcesso"
                  columnHeader="#{infoxMessages['consultaProcesso.numeroProcesso']}"
                  value="#{row.numeroProcessoRoot}" 
                  columnRendered="#{painelUsuarioController.exibirColunasPadrao}"/>
                  
                <wi:columnOutputText
                  columnId="usuarioSolicitante"
                  columnHeader="#{infoxMessages['consultaProcesso.usuarioCadastroProcesso']}"
                  value="#{row.usuarioCadastro}" 
                  columnRendered="#{painelUsuarioController.exibirColunasPadrao}"/>
                  
                <wi:columnDateTime
                  columnId="dataInicio"
                  columnHeader="#{infoxMessages['consultaProcesso.dataInicio']}"
                  value="#{row.dataInicio}"
                  columnRendered="#{painelUsuarioController.exibirColunasPadrao}" />
                  
                <wi:columnOutputText
                  columnId="natureza"
                  columnHeader="#{infoxMessages['consultaProcesso.natureza']}"
                  value="#{row.naturezaCategoriaFluxo.natureza}"
                  columnRendered="#{painelUsuarioController.exibirColunasPadrao}" />
                  
                <wi:columnOutputText
                  columnId="categoria"
                  columnHeader="#{infoxMessages['consultaProcesso.categoria']}"
                  value="#{row.naturezaCategoriaFluxo.categoria}"
                  columnRendered="#{painelUsuarioController.exibirColunasPadrao}" />
                  
                <wi:columnOutputText
                  columnId="destinatario"
                  columnHeader="#{infoxMessages['consultaProcesso.destinatario']}"
                  value="#{painelUsuarioController.getDestinatarioComunicacao(row)}" 
                  columnRendered="#{painelUsuarioController.exibirColunasPadrao}"/>
                  
                <infox:dynamicColumns columns="#{painelUsuarioController.dynamicColumns}" />
                
                <ui:define name="headerToolBar">
                    <ui:include src="/WEB-INF/xhtml/components/grid/header/tools/toolBarProcessoJbpm.xhtml" />
                </ui:define>
                
                <ui:define name="toolBar">
                    <ui:include src="/WEB-INF/xhtml/components/grid/tools/toolBarProcessoJbpm.xhtml">
                        <ui:param name="showMovimentarToolBar"
                            value="#{not painelUsuarioController.selectedFluxo.expedida}" />
                    </ui:include>
                </ui:define>
                
            </wi:dataTable>
        </s:div>
    </s:div>
	       
</ui:composition>
