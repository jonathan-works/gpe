<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:wi="http://www.itx.com.br/jsf"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:s="http://jboss.org/schema/seam/taglib"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    template="/WEB-INF/xhtml/templates/core/menuTemplate.xhtml">

    <ui:define name="title">#{messages['contaTwitter.titlePage']}</ui:define>

    <ui:param name="showSearchTab" value="false" />
    <ui:param name="home" value="#{contaTwitterCrudAction}" />

    <ui:define name="body">
        <rich:panel>
            <s:div id="idTwitterBody">
                <h:form>
                    <wi:dataForm formId="contaTwitterForm"
                        formTitle="#{messages['form.title']}"
                        requiredForm="false">
                        <rich:dataTable
                            rendered="#{contaTwitterCrudAction.managed}">
                            <f:facet name="header">
                                <h:outputText
                                    value="#{messages['contaTwitter.contaCadastrada']}" />
                            </f:facet>
                            <rich:column>
                                <f:facet name="header">
                                    <wi:toolBar id="recadastrarLink"
                                        rendered="#{contaTwitterCrudAction.managed}"
                                        onclick="if(!confirm('Deseja inativar este registro?')) return false;"
                                        action="contaTwitterCrudAction.remove()"
                                        render="idTwitterBody"
                                        url="/img/remove.png"
                                        limitToList="true"
                                        status=":status"
                                        title="#{messages['button.delete']}">
                                    </wi:toolBar>
                                </f:facet>
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">
                                    <h:outputText
                                        value="#{home.instance.screenName}" />
                                </f:facet>
                            </rich:column>
                        </rich:dataTable>
                        <s:div
                            rendered="#{!home.managed and home.requesting}"
                            id="includeTwitterDiv">
                            <wi:inputText id="pin" value="#{home.pin}"
                                label="#{messages['contaTwitter.pin']}"
                                required="false" />
                        </s:div>
                        <ui:define name="buttons">
                            <s:div rendered="#{!home.managed}">
                                <wi:commandButton id="includeButton"
                                    action="#{home.setRequesting(true)}"
                                    value="#{messages['contaTwitter.include']}"
                                    rendered="#{!home.requesting}"
                                    reRender="idTwitterBody"
                                    onclick="window.open('#{home.getAuthorizationURL()}', 'Autorizar Aplicação' ,'');" />
                                <wi:commandButton id="gravarButton"
                                    value="#{messages['crud.update']}"
                                    rendered="#{home.requesting}"
                                    reRender="idTwitterBody"
                                    action="#{home.getAutorizacao('U')}" />
                            </s:div>
                        </ui:define>
                    </wi:dataForm>
                </h:form>
            </s:div>
        </rich:panel>
    </ui:define>

</ui:composition>