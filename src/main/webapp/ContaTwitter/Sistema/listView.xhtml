<?xml version="1.0" encoding="UTF-8"?>
<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:wi="http://www.itx.com.br/jsf"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:s="http://jboss.org/schema/seam/taglib"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:a="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    template="/WEB-INF/xhtml/templates/core/menuTemplate.xhtml">
    <ui:define name="title">#{infoxMessages['contaTwitter.titlePage']}</ui:define>
    <ui:param
        name="showSearchTab"
        value="false" />
    <ui:param
        name="home"
        value="#{contaTwitterCrudAction}" />
    <ui:define name="body">
        <wi:panel
            id="contaTwitterPanel"
            styleClass="content-block">
            <wi:dataForm
                formId="contaTwitterForm"
                formTitle="#{infoxMessages['form.title']}"
                requiredForm="false">
                <rich:dataTable rendered="#{contaTwitterCrudAction.managed}">
                    <f:facet name="header">
                        <h:outputText value="#{infoxMessages['contaTwitter.contaCadastrada']}" />
                    </f:facet>
                    <rich:column>
                        <f:facet name="header">
                            <wi:toolBar
                                id="recadastrarLink"
                                rendered="#{contaTwitterCrudAction.managed}"
                                onclick="if(!confirm('Deseja inativar este registro?')) return false;"
                                action="contaTwitterCrudAction.remove()"
                                render="idTwitterBody"
                                url="#{layoutController.getResourceUrlByPath('/imagens/remove.png')}"
                                limitToList="true"
                                status=":status"
                                title="#{infoxMessages['button.delete']}">
                            </wi:toolBar>
                        </f:facet>
                    </rich:column>
                    <rich:column>
                        <f:facet name="header">
                            <h:outputText value="#{home.instance.screenName}" />
                        </f:facet>
                    </rich:column>
                </rich:dataTable>
                <s:div
                    rendered="#{!home.managed and home.requesting}"
                    id="includeTwitterDiv">
                    <wi:inputText
                        id="pin"
                        label="#{infoxMessages['contaTwitter.pin']}"
                        value="#{home.pin}"
                        required="false" />
                </s:div>
                <ui:define name="buttons">
                    <s:div rendered="#{!home.managed}">
                        <wi:commandButton
                            id="includeButton"
                            action="#{home.setRequesting(true)}"
                            value="#{infoxMessages['contaTwitter.include']}"
                            rendered="#{!home.requesting}"
                            reRender="idTwitterBody"
                            onclick="window.open('#{home.getAuthorizationURL()}', 'Autorizar Aplicação' ,'');" />
                        <wi:commandButton
                            id="gravarButton"
                            value="#{infoxMessages['crud.update']}"
                            rendered="#{home.requesting}"
                            reRender="idTwitterBody"
                            action="#{home.getAutorizacao('S')}" />
                    </s:div>
                </ui:define>
            </wi:dataForm>
        </wi:panel>
    </ui:define>
</ui:composition>