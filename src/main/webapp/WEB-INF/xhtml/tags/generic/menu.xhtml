<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: menu.xhtml 750 2010-08-24 14:10:58Z danielsilva $ -->
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a="http://richfaces.org/a4j" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" xmlns:rich="http://richfaces.org/rich"
    xmlns:infox="http://www.infox.com.br/jsf"
    xmlns:s="http://jboss.org/schema/seam/taglib" xmlns:wi="http://www.itx.com.br/jsf">
    <ui:param name="id" value="#{wi:get(id, facesContext.viewRoot.createUniqueId())}" />
   
    <div style="display: none" id="#{id}Functions">
        <h:form>
            <a:jsFunction name="#{id}OpenAjuda" execute="@this" render="@this" limitRender="true"
                actionListener="#{ajudaView.setViewId(facesContext.viewRoot.viewId.replace('.xhtml', '.seam'), true)}"
                onbegin="infox.showLoading();"
                oncomplete="openPopUp('helpwnd', '#{pathResolver.contextPath}/help/show.seam?scid=#{conversation.id}', 800,600);infox.hideLoading();">
            </a:jsFunction>
            <a:jsFunction name="#{id}PerfilSwitcher" onbegin="infox.showLoading();" oncomplete="infox.hideLoading();">
                <a:param name="idPerfil" assignTo="#{authenticator.usuarioPerfilAtualCombo}"
                 converter="javax.faces.Integer" />
            </a:jsFunction>
            <a:jsFunction name="#{id}UDCSwitcher" onbegin="infox.showLoading();" oncomplete="infox.hideLoading();">
                <a:param name="idUDC" assignTo="#{authenticator.colegiadaParaMonocraticaLogadaCombo}"
                 converter="javax.faces.Integer" />
            </a:jsFunction>
            <a:jsFunction name="#{id}SkinSwitcher" onbegin="infox.showLoading();" oncomplete="location.reload(true);">
                <a:param name="idSkin" assignTo="#{wiSkin.skin}" />
            </a:jsFunction>
            <a:jsFunction name="#{id}Logout" onbegin="infox.showLoading();" oncomplete="infox.hideLoading();"
            	action="#{authenticator.unAuthenticate()}">
            </a:jsFunction>
        </h:form>
    </div>
        
    <div id="#{id}MenuContent">
        <ui:insert />
    </div>
    <div id="#{id}"></div>
    <script>
    	(function(){
        	var #{id}MenuFunctions={
                handlePerfilClick:function(event, itm){
                   #{id}PerfilSwitcher(itm);
                },
                handleColegiadaClick:function(event, itm){
                   #{id}UDCSwitcher(itm);
                },
                handleOpenAjuda:function(event, itm){
                   infox.showLoading();
                   #{id}OpenAjuda();
                },
                handleSkinSwapClick:function(event, itm){
                    infox.showLoading();
                    #{id}SkinSwitcher(itm);
                },
                handleLogoutClick:function(event, itm){
                    #{id}Logout();
                }
            };
    		var menuConfig={
                    "content":{selector:"#{id}MenuContent"},
                    "navigationMenu":{searchPlaceholder:"Digite sua busca aqui...","items":#{menuHandler.actionMenuJson}},
                    "topMenu":{
                        searchPlaceholder:"Digite sua busca aqui...",
                        items:[
                               {"label":"#{infoxMessages['skin.title']}", hideLabel:true, icon:"#{layoutController.getMaterialDesignIconUrl('1x','black','18dp','palette')}", items:[
                                       <ui:repeat var="selItem" value="#{wiSkin.skinList}">
                                           {label:"#{selItem.label}", value:"#{selItem.value}", onClick:#{id}MenuFunctions.handleSkinSwapClick },
                                       </ui:repeat>
                               ]},
                               {label: "#{infoxMessages['ajuda.ajudaBtn']}", hideLabel:true, icon:"#{layoutController.getMaterialDesignIconUrl('1x','black','18dp','help')}", onClick:#{id}MenuFunctions.handleOpenAjuda},
                               {label: "#{infoxMessages['painel.titlePage']}", url: "#{facesContext.externalContext.context.contextPath}/Painel/list.seam", hideLabel:true, icon:"#{layoutController.getMaterialDesignIconUrl('1x','black','18dp','home')}"},
                               {label: "#{usuarioLogado} &lt;#{authenticator.usuarioPerfilAtualSingle}&gt;", iconAlign:"right", icon:"#{layoutController.getMaterialDesignIconUrl('1x','black','18dp','person')}", "items":[
               					{"label":"Perfis", showChildren:true, items:[
                                         <ui:repeat var="selItem" value="#{authenticator.usuarioPerfilListItems}">
                                             {label:"#{selItem.label}", value:"#{selItem.value}", onClick:#{id}MenuFunctions.handlePerfilClick },
                                         </ui:repeat>
               					]},
               					<c:if test="#{authenticator.usuarioLogadoInMonocratica}">
               					{"label":"Unidades Decisoras Colegiadas", showChildren:true, items:[
                                       <ui:repeat var="selItem" value="#{authenticator.colegiadaParaMonocraticaLogadaListItems}">
                                       	{label:"#{selItem.label}", value:"#{selItem.value}", onClick:#{id}MenuFunctions.handleColegiadaClick },
                                       </ui:repeat>
               					]}
               					</c:if>
               				]},	
                               {"label": "#{infoxMessages['menu.logout']}", onClick:#{id}MenuFunctions.handleLogoutClick, hideLabel:true, icon:"#{layoutController.getMaterialDesignIconUrl('1x','black','18dp','power_settings_new')}"}
               				]
                    }
                };
             ReactDOM.render(
                     
                     React.createElement(window['react-components'].NavigationMenu, menuConfig),
                     document.getElementById("#{id}")
            );
    	})();
    </script>

</ui:composition>
