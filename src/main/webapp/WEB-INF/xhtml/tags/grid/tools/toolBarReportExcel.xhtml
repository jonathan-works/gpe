<?xml version="1.0" encoding="UTF-8"?>
<ui:composition
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:c="http://java.sun.com/jsp/jstl/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:s="http://jboss.org/schema/seam/taglib"
  xmlns:a="http://richfaces.org/a4j"
  xmlns:wi="http://www.itx.com.br/jsf"
>
  <s:span
    rendered="#{wi:get(rendered, 'true')}"
    styleClass="tb-rprt-xls"
  >
    <h:form>
      <c:if test="#{not empty reportPath}">
        <s:link
          view="#{empty reportPath ? pathResolver.viewIdDirectory.concat('excelReport.xhtml') : reportPath}"
          target="_blank"
        >
          <h:graphicImage
            url="#{a4jSkin.imgIconExcel}"
            title="#{messages['report.exportXLS']}"
          />
        </s:link>
      </c:if>
      <a:region>
        <h:commandLink action="#{elFunctions.invokeMethod(action)}">
          <h:graphicImage
            url="#{a4jSkin.imgIconExcel}"
            title="#{messages['report.exportXLS']}"
          />
        </h:commandLink>
      </a:region>
    </h:form>
  </s:span>
</ui:composition>
