<?xml version="1.0" encoding="UTF-8"?>

<ui:composition
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:a="http://richfaces.org/a4j"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:s="http://jboss.org/schema/seam/taglib"
  xmlns:wi="http://www.itx.com.br/jsf">

  <h:panelGroup id="#{empty id ? 'divApplet' : id}">
    <s:fragment rendered="#{empty rendered ? true : rendered}">

      <h:inputHidden
        id="#{id}Signature"
        value="#{signatureField}">
      </h:inputHidden>
      <h:inputHidden
        id="#{id}CertChain"
        value="#{certificationChainField}">
      </h:inputHidden>
      <script src="#{pathResolver.contextPath}/resources/js/certificadoDigital/constant.js" />
      <script src="#{pathResolver.contextPath}/resources/js/certificadoDigital/websocket.js" />
      
      <h:commandButton type="button" styleClass="buttons" 
      		onclick="location.href='#{pathResolver.contextPath}/certificado/certificado_digital.jnlp'"
          	onmouseup="Infox.CertDig.userClickedOnDownloadJNPLButton();"
      		value="#{empty signButtonCaption ? 'Assinar Digitalmente' : signButtonCaption}" />
                  		
      <h:outputScript>
	      Infox.CertDig.Functions = {
	        getData : function getData() {
	          return "#{signableData}";
	        }
	      };
	      
		  Infox.CertDig.Constant.Parameter = 
	 	  {
			  DEBUG                      : #{empty debug ? false : debug},
		
			  LOGIN_MODE                 : #{empty loginMode ? false : loginMode},
		
			  FORM_ID                    : "#{formId}",
			  CERTIFICATION_CHAIN_FIELD  : "#{rich:clientId(id.concat('CertChain'))}",
			  SIGNATURE_FIELD            : "#{rich:clientId(id.concat('Signature'))}",
			  GET_DATA_FUNCTION          : "Infox.CertDig.Functions.getData()",
			
			  FUNCTION_PRE_SIGN          : "#{functionPreSign}",
			  FUNCTION_POS_SIGN          : "#{functionPosSign}",
			  FUNCTION_POS_SIGN_OK       : "#{functionPosSignOk}",
			  FUNCTION_POS_SIGN_ERROR    : "#{functionPosSignError}",
			
			  DATA_ATUAL                 : "#{currentDatetime}",
			  USE_BASE64_FUNCTION        : #{empty useBase64Function ? true : useBase64Function},
			  USE_PROVIDER_DLL           : #{empty useProviderDll ? false : useProviderDll}
		  };
	  </h:outputScript>
    </s:fragment>
  </h:panelGroup>
</ui:composition>