<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
  IBPM - Ferramenta de produtividade Java
  Copyright (c) 1986-2009 Infox Tecnologia da Informação Ltda.
 
  Este programa é software livre; você pode redistribuí-lo e/ou modificá-lo 
  sob os termos da GNU GENERAL PUBLIC LICENSE (GPL) conforme publicada pela 
  Free Software Foundation; versão 2 da Licença.
  Este programa é distribuído na expectativa de que seja útil, porém, SEM 
  NENHUMA GARANTIA; nem mesmo a garantia implícita de COMERCIABILIDADE OU 
  ADEQUAÇÃO A UMA FINALIDADE ESPECÍFICA.
  
  Consulte a GNU GPL para mais detalhes.
  Você deve ter recebido uma cópia da GNU GPL junto com este programa; se não, 
  veja em http://www.gnu.org/licenses/  
-->
<ui:composition
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:s="http://jboss.org/schema/seam/taglib"
	xmlns:wi="http://www.itx.com.br/jsf">

	<ui:param
		name="varsList"
		value="#{showVariables ? 'epaInsert,|,' : '' }" />
	<ui:param
		name="template"
		value="#{wi:get(template, '/WEB-INF/xhtml/components/templates/edit.xhtml')}" />

	<s:decorate
		id="#{id}Decoration"
		template="#{template}"
		rendered="#{wi:get(rendered, true)}"
		style="clear:both">

		<script
			type="text/javascript">
			// Conteudo da lista de selecao
			var contents = {
				<a:repeat
                 value="#{modeloDocumentoHome.variaveis}"
                 var="v">
					'#{v.variavel}' : '\#{'+'#{v.variavel}'+'}' ,
				</a:repeat>
			};
			// Label da lista de variáveis
			var label = 'Variáveis';

			function tabKeyAction(event) {
				if (event.data.keyCode == 9) {
					//insere espaços em branco
					editor.selection.setContent("            ");
					//cancelando a ação padrão da tecla tab, que seria ir para o próximo campo.
					event.preventDefault();
					return false;
				}
			}
		</script>

		<ui:define name="label">#{label}</ui:define>
		<span id="#{id}Locator" />
		<rich:editor
			id="#{id}"
			value="#{value}"
			toolbar="#{wi:get(toolbar, 'InfoxToolbar')}"
			width="#{wi:get(width, 650)}"
			height="#{wi:get(height, 350)}"
			readonly="#{readonly}"
			required="#{required}"
			onchange="#{wi:get(onchange, 'void(0);')}"
			customPlugins="epaPlugins">
			
			<f:facet name="config">
				toolbar_InfoxToolbar:
				[
				{ name: 'editing', items: ['Cut', 'Copy', 'Paste', '-', 'Find', 'Replace', '-', 'Undo', 'Redo'] },
				{ name: 'basicstyles', items: ['Bold', 'Italic', 'Strike', 'Underline'] },
				],
				on: {
					instanceReady: function() {
						this.on('key', tabKeyAction);
					}
				}
			</f:facet>
			
			<f:param
				name="language"
				value="pt" />
			<f:param
				name="relative_urls"
				value="false" />
			<f:param
				name="theme_advanced_toolbar_location"
				value="top" />
			<f:param
				name="theme_advanced_toolbar_align"
				value="left" />
			<f:param
				name="plugins"
				value="epa,spellchecker,table,advhr,advimage,advlink,inlinepopups,searchreplace,print,contextmenu,paste,fullscreen,visualchars" />
			<f:param
				name="theme_advanced_buttons1_add"
				value="fontselect,fontsizeselect,|,selectall,cut,copy,paste,pastetext,pasteword,|,search,replace" />
			<f:param
				name="theme_advanced_buttons2_add"
				value="#{varsList},blockquote,insertdate,inserttime,forecolor,backcolor,|,tablecontrols" />
			<f:param
				name="theme_advanced_buttons3_add"
				value="visualchars,advhr,|,print,|,spellchecker,|,undo,redo,|,fullscreen" />
			<f:param
				name="theme_advanced_disable"
				value="formatselect,styleselect,link,image,unlink,anchor,cleanup,help,code" />
			<f:param
				name="setup"
				value="tabKeyAction" />
			<ui:insert />
		</rich:editor>
		<ui:insert name="conteudoApplet" />
	</s:decorate>

</ui:composition>
