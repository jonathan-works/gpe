<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
  IBPM - Ferramenta de produtividade Java
  Copyright (c) 1986-2009 Infox Tecnologia da Informação Ltda.
 
  Este programa é software livre; você pode redistribuí-lo e/ou modificá-lo 
  sob os termos da GNU GENERAL PUBLIC LICENSE (GPL) conforme publicada pela 
  Free Software Foundation; versão 2 da Licença.
  Este programa é distribuído na expectativa de que seja útil, porém, SEM 
  NENHUMA GARANTIA; nem mesmo a garantia implícita de COMERCIABILIDADE OU 
  ADEQUAÇÃO A UMA FINALIDADE ESPECÍFICA.
  
  Consulte a GNU GPL para mais detalhes.
  Você deve ter recebido uma cópia da GNU GPL junto com este programa; se não, 
  veja em http://www.gnu.org/licenses/  
-->
<ui:composition
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:s="http://jboss.org/schema/seam/taglib"
	xmlns:wi="http://www.itx.com.br/jsf">

	<ui:param
		name="tree"
		value="#{wi:get(tree, eventsTree)}" />

	<s:div
		id="#{id}EventsTreeDiv"
		rendered="#{wi:get(rendered, true)}">
		<s:fragment rendered="#{!tree.registred}">
			<s:decorate
				id="#{id}DecorationEventsTree"
				template="/WEB-INF/xhtml/components/templates/view.xhtml">
				<ui:param
					name="width"
					value="#{wi:get(width, '400px')}" />
				<s:div rendered="#{wi:get(rendered, tree.renderTree)}">
					<fieldset >
						<legend >
							<h:outputText value="Selecione o(s) Evento(s)" />
						</legend>
						<h:outputText
							rendered="#{empty agrupamentos}"
							styleClass="error"
							value="Não foram informados agrupamentos para este componente" />
						<rich:tree
							data="#{item}"
							render="#{id}EventsTreeDiv, #{reRender}"
							status="status"
							toggleType="client"
							execute="@this"
							selectionType="ajax"
							rendered="#{not empty agrupamentos}"
							selectionChangeListener="#{tree.processTreeSelectionChange}"
							>
							<rich:treeModelRecursiveAdaptor
								roots="#{tree.getRoots(agrupamentos)}"
								nodes="#{item.nodes}">
								<rich:treeNode
									render="#{id}EventsTreeDiv, #{reRender}"
									iconCollapsed="/img/nivelTree.gif"
									iconExpanded="/img/nivelTree.gif"
									iconLeaf="/img/file.gif">
									<h:outputText value="#{item}" />
								</rich:treeNode>
							</rich:treeModelRecursiveAdaptor>
						</rich:tree>
					</fieldset>
				</s:div>
			</s:decorate>
			<rich:dataTable
				id="#{id}selectedEventsTable"
				rows="10"
				value="#{tree.eventoBeanList}"
				var="row"
				>
				<f:facet name="header">
					<rich:columnGroup>
						<rich:column>
							<h:outputText value="" />
						</rich:column>
						<rich:column>
							<h:outputText value="Evento" />
						</rich:column>
						<rich:column>
							<h:outputText value="Quantidade" />
						</rich:column>
					</rich:columnGroup>
				</f:facet>
				<rich:column >
					<a:commandLink
						action="#{tree.removeEvento(row)}"
						execute="@this"
						render="#{id}EventsTreeDiv, #{reRender}"
						rendered="#{row.excluir}">
						<h:graphicImage url="/img/remove.png" />
					</a:commandLink>
				</rich:column>
				<rich:column >
					<h:outputText value="#{row.evento}" />
				</rich:column>
				<rich:column >
					<center>
						<rich:inputNumberSpinner
							minValue="1"
							disabled="#{!row.multiplo}"
							inputStyle="width: 30px; height: 17px; text-align: right;"
							styleClass="rich-spinner-button"
							value="#{row.quantidade}" />
					</center>
				</rich:column>
				<f:facet name="footer">
					<rich:dataScroller
						id="#{id}ds"
						align="center"
						for="#{id}selectedEventsTable" />
				</f:facet>
			</rich:dataTable>
		</s:fragment>
	</s:div>

</ui:composition>
