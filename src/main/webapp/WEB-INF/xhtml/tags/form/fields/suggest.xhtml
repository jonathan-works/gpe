<?xml version="1.0" encoding="ISO-8859-1"?>

<!--
  IBPM - Ferramenta de produtividade Java
  Copyright (c) 1986-2009 Infox Tecnologia da Informação Ltda.
 
  Este programa é software livre; você pode redistribuí-lo e/ou modificá-lo 
  sob os termos da GNU GENERAL PUBLIC LICENSE (GPL) conforme publicada pela 
  Free Software Foundation; versão 2 da Licença.
  Este programa é distribuído na expectativa de que seja útil, porém, SEM 
  NENHUMA GARANTIA; nem mesmo a garantia implícita de COMERCIABILIDADE OU 
  ADEQUAÇÃO A UMA FINALIDADE ESPECÍFICA.
  
  Consulte a GNU GPL para mais detalhes.
  Você deve ter recebido uma cópia da GNU GPL junto com este programa; se não, 
  veja em http://www.gnu.org/licenses/  
--> 

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:s="http://jboss.org/schema/seam/taglib"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:wi="http://www.itx.com.br/jsf"
				xmlns:c="http://java.sun.com/jstl/core"
				xmlns:a="http://richfaces.org/a4j"
				xmlns:rich="http://richfaces.org/rich">

	<ui:param name="width" value="#{empty props.width ? '250' : props.width}" />
	<ui:param name="widthBoxSuggest" value="#{empty props.widthBoxSuggest ? '250' : props.widthBoxSuggest}" />
	<ui:param name="maxlength" value="#{empty maxlength ? '50' : maxlength}" />
	<ui:param name="template" value="#{empty template ? '/WEB-INF/xhtml/components/templates/edit.xhtml' : template}" />
	<ui:param name="minChars" value="#{empty props.minChars ? (empty minChars ? '1' : minChars) : props.minChars}" />		
	<ui:param name="id" value="#{empty id ? f.id : id}" />

	<s:decorate template="#{template}" rendered="#{wi:get(rendered, true)}">

		<ui:define name="label">#{label}</ui:define>
		
		<c:if test="#{!empty assignTo}">
			#{bean.setExpression(assignTo)}
		</c:if>			
		
		<h:inputText id="#{id}" 
					 maxlength="#{maxlength}" 
					 required="#{required}"
					 onkeyup="#{onkeyup}"
					 disabled="#{disabled}"
					 styleClass="suggest" 
					 style="width: #{width - 20}px"
					 value="#{bean.defaultValue}">
				<a:support event="onchange" 
						   action="#{bean.setInstance(null)}" 
						   reRender="#{reRender}"
						   status=":status"
						   ajaxSingle="true"
						   onsubmit="if(this.value != '') return false;"/>
		</h:inputText>
	  	<rich:suggestionbox	width="#{widthBoxSuggest}" 
				  			height="200"
				  	 	    status=":status" 
				  	 	    frequency="1"
				  	 	    minChars="#{minChars}"
				  	 	    eventsQueue="suggest"
				  		    rendered="#{empty props.hideSuggest}"
				  		    nothingLabel="Termo não encontrado"
				  		    var="var"
				  		    fetchValue="#{fetch}"
				  		    for="#{id}"
				  		    suggestionAction="#{bean.suggestList}">
			<ui:insert name="columns">
				<h:column>
					<h:outputText value="#{var}" />
				</h:column>
			</ui:insert>

			<ui:insert />

			<a:support	event="onselect"
						oncomplete="#{oncomplete}" 
						status=":status" 
						reRender="#{reRender}"
						ajaxSingle="true"
						limitToList="#{empty reRender ? false : true}"
						eventsQueue="suggest">  
		         <f:setPropertyActionListener value="#{var}"  
		                 					  target="#{bean.instance}" />
		    </a:support>  						  
	  	</rich:suggestionbox>
	</s:decorate>
	
</ui:composition>