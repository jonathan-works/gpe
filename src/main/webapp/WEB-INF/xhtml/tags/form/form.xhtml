<?xml version="1.0" encoding="UTF-8"?>
<!--
  IBPM - Ferramenta de produtividade Java
  Copyright (c) 1986-2009 Infox Tecnologia da Informação Ltda.
 
  Este programa é software livre; você pode redistribuí-lo e/ou modificá-lo 
  sob os termos da GNU GENERAL PUBLIC LICENSE (GPL) conforme publicada pela 
  Free Software Foundation; versão 2 da Licença.
  Este programa é distribuído na expectativa de que seja útil, porém, SEM 
  NENHUMA GARANTIA; nem mesmo a garantia implícita de COMERCIABILIDADE OU 
  ADEQUAÇÃO A UMA FINALIDADE ESPECÍFICA.
  
  Consulte a GNU GPL para mais detalhes.
  Você deve ter recebido uma cópia da GNU GPL junto com este programa; se não, 
  veja em http://www.gnu.org/licenses/  
--><ui:composition
	 xmlns:ui="http://java.sun.com/jsf/facelets"
	 xmlns="http://www.w3.org/1999/xhtml"
	 xmlns:a="http://richfaces.org/a4j"
	 xmlns:c="http://java.sun.com/jsp/jstl/core"
	 xmlns:f="http://java.sun.com/jsf/core"
	 xmlns:h="http://java.sun.com/jsf/html"
	 xmlns:rich="http://richfaces.org/rich"
	 xmlns:s="http://jboss.org/schema/seam/taglib"
	 xmlns:infox="http://www.infox.com.br/jsf"
	 xmlns:wi="http://www.itx.com.br/jsf">
	

	<c:if test="#{! empty form}">
		

		<ui:param
			 name="formId"
			 value="#{empty formId ? form.formId.concat('Form') : formId}" />
		<ui:param
			 name="formIdAcs"
			 value="#{form.formId.concat('Form')}" />

		<c:if test="#{not empty home}">
			#{form.setHome(home.homeName)}
		</c:if>

		<ui:param
			 name="home"
			 value="#{empty home ? form.home : home}" />
		<ui:param
			 name="instance"
			 value="#{home.instance}" />
		<h:form id="#{formId}">
			
			<a:region>
				
				<s:div styleClass="edit">
					
					<rich:panel >
						
						<f:facet name="header">#{empty formTitle ? formId : formTitle}</f:facet>
						<s:div >
							
							<c:if test="#{form.tabbed}">
								
								<infox:tabPanel switchType="client">
									<infox:tabHeaders />
									<ui:repeat
										 value="#{form.rootFields}"
										 var="rf">
										
										<ui:param
											 name="id"
											 value="#{rf.id}" />
										<ui:param
											 name="props"
											 value="#{rf.properties}" />
										<ui:param
											 name="value"
											 value="#{home.instance[id]}" />
										<ui:param
											 name="label"
											 value="#{empty props.label ? rf.label : props.label}" />
										<ui:param
											 name="label"
											 value="#{expressions.createValueExpression(label).value}" />
										<ui:param
											 name="rendered"
											 value="#{empty props.rendered ? rf.rendered : props.rendered}" />
										<ui:param
											 name="rendered"
											 value="#{empty rendered ? true : rendered}" />
										<ui:param
											 name="required"
											 value="#{empty props.required ? rf.required : props.required}" />
										<ui:param
											 name="disabled"
											 value="#{props.disabled}" />
										<ui:param
											 name="reRender"
											 value="#{empty props.reRender ? reRender : props.reRender}" />
										<ui:param
											 name="readonly"
											 value="#{empty props.readonly ? false : util.eval(props.readonly)}" />
										<ui:param
											 name="maxlength"
											 value="#{props.length}" />
										<ui:param
											 name="bypassUpdate"
											 value="#{props.bypassUpdate}" />
										<ui:include
											 id="#{rf.id}"
											 src="/WEB-INF/xhtml/components/form/#{rf.type}.xhtml" />
									
									</ui:repeat>
								
								</infox:tabPanel>
							
							</c:if>
							<c:if test="#{!form.tabbed}">
								
								<ui:repeat
									 value="#{form.fields}"
									 var="f">
									
									<ui:param
										 name="id"
										 value="#{f.id}" />
									<ui:param
										 name="props"
										 value="#{f.properties}" />
									<ui:param
										 name="value"
										 value="#{home.instance[id]}" />
									<ui:param
										 name="disabled"
										 value="#{props.disabled}" />
									<ui:param
										 name="label"
										 value="#{empty props.label ? f.label : props.label}" />
									<ui:param
										 name="label"
										 value="#{expressions.createValueExpression(label).value}" />
									<ui:param
										 name="rendered"
										 value="#{empty props.rendered ? f.rendered : props.rendered}" />
									<ui:param
										 name="rendered"
										 value="#{empty rendered ? true : rendered}" />
									<ui:param
										 name="required"
										 value="#{empty props.required ? f.required : props.required}" />
									<ui:param
										 name="bypassUpdate"
										 value="#{props.bypassUpdate}" />
									<ui:param
										 name="reRender"
										 value="#{empty props.reRender ? reRender : props.reRender}" />
									<ui:param
										 name="readonly"
										 value="#{empty props.readonly ? false : util.eval(props.readonly)}" />
									<ui:param
										 name="maxlength"
										 value="#{props.length}" />
									<ui:param
										 name="type"
										 value="#{f.type.startsWith('documentoIdentificacaoHome') ? 'docsIdentificacao/'.concat(util.eval(f.type)) : f.type }" />
									<ui:include src="/WEB-INF/xhtml/components/form/#{type}.xhtml" />
								
								</ui:repeat>
							
							</c:if>
							<div >
								
								<s:div rendered="#{canEdit and !empty form.fields and form.hasRequiredField()}">
									
									<img src="#{util.contextPath}#{a4jSkin.imgIconBalao}" />
									<span class="required">*</span>
		                   Campos Obrigatórios                                                       	
		                
								</s:div>
							
							</div>
						
						</s:div>
					
					</rich:panel>


					<c:if test="#{wi:get(canEdit, true)}">
						
						<s:div id="divBotao">
							
							<ui:param
								 name="buttons"
								 value="#{form.buttons.id}#{empty modalPanelId ? '' : '_modal'}" />
							<ui:include src="/WEB-INF/xhtml/components/form/buttons/#{buttons}.xhtml" />
						
						</s:div>
					
					</c:if>

				
				</s:div>
			
			</a:region>
		
		</h:form>
		<s:fragment rendered="#{!empty focus}">
			
			<script type="text/javascript">
				invoke(["infox.escapeId"],function(EscapeId) {
					var id = EscapeId("#{formId}:#{focus}:#{focus}Decoration:#{focus}");
					$(id).focus();
				});
			</script>
		
		</s:fragment>
	
	</c:if>


</ui:composition>
