<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- $Id: menu.xhtml 750 2010-08-24 14:10:58Z danielsilva $ --><ui:composition
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:a="http://richfaces.org/a4j"
     xmlns:c="http://java.sun.com/jsp/jstl/core"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:rich="http://richfaces.org/rich"
     xmlns:s="http://jboss.org/schema/seam/taglib"
     xmlns:wi="http://www.itx.com.br/jsf">

	<h:form>
	 	<a:jsFunction
             status="status"
             name="refreshPage"
             render="pageBody"
             limitRender="true"/>
    </h:form>
    <script type="text/javascript">window.addEventListener("load",function() { alert("Remover a referência para este menu");});</script>
	<ui:param
         name="mostrarMenu"
         value="#{identity.loggedIn and !usuarioLogado.provisorio}" />
	
	<h:form
         style="position: absolute; right:0px; top:0px;"
         rendered="#{mostrarMenu}">			
		<table
             cellspacing="0"
             cellpadding="0"
             style="vAlign: middle">
	      <tr>
	        <td
                     class="modPesqEsq" />		        
	        <td
                     class="modPesqBg"> 
	            <span
                         style="font-size: 11px; color: #FFFFFF; font-weight: bold;">
				    Pesquisar
				</span>
				<h:inputText
                         styleClass="modPesqInputText"
                         id="searchText"
                         value="#{search.searchText}" />					
	        </td>	          
	        <td
                     class="modPesqBg">
		         <h:commandButton
                         style="top:0px;"
                         action="/Pesquisa/searchResult.xhtml"
                         image="#{a4jSkin.imgBgButtonPesq}" />
	        </td> 
	        <td
                     class="modPesqBg"
                     valign="top">
		        <h:graphicImage
                         url="#{a4jSkin.imgIconPalette}"
                         style="cursor:pointer"
                         title="Alterar o esquema de cores"
                         onclick="Richfaces.showModalPanel('skinPanel')" />	
    				 							
				<h:commandButton
                         action="#{skinZoom.setTmNormal()}"
                         image="#{a4jSkin.imgIconZoomNormal}"
                         style="width: 17px; height: 21px;" />	
					
			    <h:commandButton
                         action="#{skinZoom.setTmMedio()}"
                         image="#{a4jSkin.imgIconZoomMedio}"
                         style="width: 17px; height: 21px;" />
			    
			    <h:commandButton
                         action="#{skinZoom.setTmGrande()}"
                         image="#{a4jSkin.imgIconZoomGrande}"
                         style="width: 17px; height: 21px;" />	
	        </td>      
	      </tr>
	    </table>			
	</h:form>

	<s:div
         style="color:#{a4jSkin.colorTextMenu};     position: absolute; top: 47px;     text-align: right; height: 45px;    overflow:hidden;     width:50%;    right: 5px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;        font-size: 10pt; font-weight: bold;">
	    <h:outputText
             value="#{usuarioLogado}"
             rendered="#{identity.loggedIn}" />

	    <h:form
             id="papeisUsuarioForm">
		    <wi:selectOneMenuEntity
                 value="#{authenticator.localizacaoAtualCombo}"
                 rendered="#{authenticator.usuarioLocalizacaoListItems.size() gt 1}"
                 id="usuarioLocalizacao"
                 template="/WEB-INF/xhtml/components/templates/display.xhtml"
                 style="position:absolute; right: 0px;      color:#{a4jSkin.colorTextMenu};         font-size:14px;         width:auto;         text-align:right;         background-color:transparent; border:none"
                 onchange="this.form.submit()"
                 items="#{authenticator.usuarioLocalizacaoListItems}">
		    </wi:selectOneMenuEntity><br />
		    <h:outputText
                 value="#{authenticator.usuarioLocalizacaoListItems[0]}"
                 style="position:absolute; right: 0px;         background-color:transparent;         font-size:14px;         color:#{a4jSkin.colorTextMenu};         font-weight: normal;"
                 rendered="#{identity.loggedIn and authenticator.usuarioLocalizacaoListItems.size() == 1}" />
	    </h:form>
	    
	</s:div>
#{mostrarMenu}
	<rich:toolbar
         width="100%">
		<c:if
             test="#{mostrarMenu}">
			<rich:toolbarGroup>
				<s:link
                     view="/home.xhtml"
                     style="color:#{a4jSkin.headerTextColor}; font-size:#{skinZoom.skinZoom};"
                     value="Home" />				
			</rich:toolbarGroup>
			<c:forEach
                 items="#{mainMenu.dropMenus}"
                 var="drop">
				<c:if
                     test="#{empty drop.url}">
					<h:form>
						<rich:dropDownMenu
                             value="#{drop.label}">
							<ui:include
                                 src="/WEB-INF/xhtml/templates/subMenu.xhtml">
								<ui:param
                                     name="subMenu"
                                     value="#{drop}" />
							</ui:include>
						</rich:dropDownMenu>
					</h:form>
				</c:if>
				<c:if
                     test="#{!empty drop.url}">
					<h:form>
						<rich:menuItem
                             submitMode="server"
                             label="#{drop.label}"
                             action="#{drop.url}">
							<s:conversationPropagation
                                 type="end" />
						</rich:menuItem>
					</h:form>
				</c:if>
			</c:forEach>
		</c:if>
		<rich:toolbarGroup
             location="right">
			<s:link
                 view="/login.xhtml"
                 value="Login"
                 style="color:#{a4jSkin.headerTextColor}"
                 rendered="#{not identity.loggedIn}" />
			<s:link
                 view="/home.xhtml"
                 action="#{identity.logout}"
                 style="color:#{a4jSkin.headerTextColor}; font-size:#{skinZoom.skinZoom};"
                 value="Logout"
                 rendered="#{identity.loggedIn}" />
			<wi:helpIcon />								
		</rich:toolbarGroup>
	</rich:toolbar>

	<rich:popupPanel
         id="skinPanel"
         height="100">
		<f:facet
             name="header">Esquema de cores da aplicação</f:facet>
		<f:facet
             name="controls">
			<h:panelGroup>
				<h:graphicImage
                     value="/img/closeMP.gif"
                     onclick="Richfaces.hideModalPanel('skinPanel')" />
			</h:panelGroup>				
		</f:facet>
		<s:decorate
             template="/WEB-INF/xhtml/components/templates/edit.xhtml">
			<ui:define
                 name="label">
				<h:outputText
                     value="Escolha o esquema:"
                     styleClass="label" />
			</ui:define>
			<h:form>
				<h:selectOneMenu
                     value="#{wiSkin.skin}"
                     style="width: 250px"
                     onchange="this.form.submit()">
					<f:selectItems
                         value="#{wiSkin.skinList}" />
				</h:selectOneMenu>
			</h:form>
		</s:decorate>
	</rich:popupPanel>

</ui:composition>
